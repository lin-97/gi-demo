const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["static/js/FileList-D0iQVzzV.js","static/js/index-CaTNYhxh.js","static/css/index-DMXLQ8W3.css","static/js/FileImage-DcvaH8gN.js","static/js/index-C142IXbk.js","static/css/index-DIweq_8K.css","static/js/file-vS2Qaiq0.js","static/css/FileImage-C2IhPtGp.css","static/js/FileRightMenu-CFcs1On4.js","static/js/index-BYww2ZEJ.js","static/css/index-D8CmNKQ4.css","static/css/FileRightMenu-DeeoGSHj.css","static/css/FileList-C2PP9OlD.css"])))=>i.map(i=>d[i]);
import{e,M as a,Z as t,J as l,e$ as i,f0 as n,eT as o,c as s,ah as d,d as u,p as c,s as r,Q as m,f1 as p,f,g as _,o as v,j as h,w as g,G as y,i as k,F as w,k as b,a as x,t as j,r as C,h as F,b as I,A as M,ao as T,f2 as S,eU as P,_ as R}from"./index-CaTNYhxh.js";import{_ as N}from"./index-C142IXbk.js";import{q as A}from"./index-BKARVhZx.js";import L from"./ModalContent-SrrYBODp.js";import{_ as B}from"./ModalContent.vue_vue_type_script_setup_true_lang-BIefRkeM.js";import{_ as O}from"./ModalContent.vue_vue_type_script_setup_true_lang-BNSHkbCy.js";import q from"./ModalContent-Dg44cOmO.js";import E from"./FilePath-BEzaN0Qx.js";import U from"./FileGrid-Dn5dTu7w.js";import{I as V,F as W}from"./file-vS2Qaiq0.js";import"./index-CWsJrtG_.js";import"./FileImage-DcvaH8gN.js";import"./FileRightMenu-CFcs1On4.js";import"./index-BYww2ZEJ.js";let $="";function G(e){if(!$)return $=e.id,function(e,a){const t=document.createElement("div");document.body.appendChild(t);const l=i(e,{...a,onClose:()=>{setTimeout(()=>{l.unmount(),document.body.removeChild(t),(null==a?void 0:a.callback)&&(null==a||a.callback())},350)}});l.use(n),l.use(o),l.mount(t)}(q,{data:e,callback:()=>{$=""}})}const z={class:"file-main"},D=R(u({__name:"index",setup(i){const n=S(()=>P(()=>import("./FileList-D0iQVzzV.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12]))),o=c(),u=r(),{mode:R,selectedFileIds:q,toggleMode:$,addSelectedFileItem:D}=function(){const a=e("grid"),t=e([]),l=s(()=>t.value.map(e=>e.id));return{mode:a,selectedFileList:t,selectedFileIds:l,toggleMode:()=>{a.value="grid"===a.value?"list":"grid"},addSelectedFileItem:e=>{if(l.value.includes(e.id)){const a=t.value.findIndex(a=>a.id===e.id);t.value.splice(a,1)}else t.value.push(e)}}}(),J=e(!1),K=e(!1),Q=e([]),Z=e("0");Z.value=o.query.fileType||"0";const H=async()=>{try{J.value=!0,K.value=!1;const a=await(e={fileType:Z.value},d.get("/file/getFileList",e));Q.value=a.data.records}catch(a){return a}finally{J.value=!1}var e},X=()=>{H()};m(()=>{H()}),p(e=>{Z.value=e.query.fileType||"0",H()});const Y=s(()=>Q.value.filter(e=>V.includes(e.extendName)).map(e=>e.src??"")),ee=e=>{if(l.success(`点击了文件-${e.name}`),V.includes(e.extendName)&&e.src&&Y.value.length){const a=Y.value.findIndex(a=>a===e.src);A({images:Y.value,options:{initialViewIndex:a}})}var i;"mp4"===e.extendName&&(i=e,a.open({title:"视频播放",width:"auto",modalStyle:{},content:()=>t(O,{data:i})})),"mp3"===e.extendName&&G(e)},ae=e=>{D(e)},te=(i,n)=>{l.success(`点击了${i}`),"delete"===i&&a.warning({title:"提示",content:"是否删除该文件？",hideCancel:!1,okButtonProps:{status:"danger"},onBeforeOk:async()=>await new Promise(e=>setTimeout(()=>e(!0),300))}),"rename"===i&&function(i){const n=e();a.open({title:"重命名",width:"90%",modalStyle:{maxWidth:"450px"},modalAnimationName:"el-fade",content:()=>t(B,{ref:e=>{var a;n.value=e,null==(a=n.value)||a.setForm({id:i.id,name:i.name})}}),onBeforeOk:async()=>{var e,a;return!(await(null==(a=null==(e=n.value)?void 0:e.formRef)?void 0:a.validate()))&&(await new Promise(e=>setTimeout(()=>e(!0),300)),l.success("重命名成功"),!0)}})}(n),"move"===i&&function(i){const n=e();a.open({title:"移动到",width:"90%",modalStyle:{maxWidth:"500px"},modalAnimationName:"el-dialog",maskAnimationName:"el-mask",content:()=>t(L,{ref:e=>{var a;n.value=e,null==(a=n.value)||a.setForm({id:i.id,path:i.filePath})}}),onBeforeOk:async()=>{var e,a;return!(await(null==(a=null==(e=n.value)?void 0:e.formRef)?void 0:a.validate()))&&(await new Promise(e=>setTimeout(()=>e(!0),300)),l.success("移动成功"),!0)}})}(n),"detail"===i&&u.push({path:"/file/detail"})},le=()=>{a.warning({title:"提示",content:"是否确认删除？",hideCancel:!1})};return(e,a)=>{const t=f("icon-upload"),l=f("a-button"),i=N,o=f("a-doption"),s=f("a-dropdown"),d=f("a-option"),u=f("a-select"),c=f("a-input"),r=f("icon-search"),m=f("a-input-group"),p=f("a-space"),S=f("icon-delete"),P=f("icon-select-all"),A=f("icon-swap"),L=f("a-tooltip"),B=f("icon-filter"),O=f("icon-apps"),V=f("icon-list"),G=f("a-button-group"),D=f("a-row"),Z=f("a-empty"),H=f("a-spin");return v(),_("div",z,[h(E),h(D,{justify:"space-between",class:"file-main__search"},{default:g(()=>[h(p,{wrap:""},{default:g(()=>[h(s,null,{content:g(()=>[h(o,null,{icon:g(()=>[h(i,{name:"upload-file"})]),default:g(()=>[a[2]||(a[2]=k("span",null,"上传文件",-1))]),_:1,__:[2]}),h(o,null,{icon:g(()=>[h(i,{name:"upload-folder"})]),default:g(()=>[a[3]||(a[3]=k("span",null,"上传文件夹",-1))]),_:1,__:[3]})]),default:g(()=>[h(l,{type:"primary",shape:"round"},{icon:g(()=>[h(t)]),default:g(()=>a[1]||(a[1]=[y("上传",-1)])),_:1})]),_:1}),h(m,null,{default:g(()=>[h(u,{placeholder:"请选择","trigger-props":{autoFitPopupMinWidth:!0},style:{width:"150px"}},{default:g(()=>[(v(!0),_(w,null,b(F(W),e=>(v(),x(d,{key:e.value},{icon:g(()=>[(v(),x(C(e.icon),{size:"18",color:"#999"}))]),default:g(()=>[y(j(e.name),1)]),_:2},1024))),128))]),_:1}),h(c,{placeholder:"请输入关键词...","allow-clear":""}),h(l,{type:"primary",onClick:X},{icon:g(()=>[h(r)]),default:g(()=>a[4]||(a[4]=[y("搜索",-1)])),_:1})]),_:1})]),_:1}),h(p,{wrap:""},{default:g(()=>[F(K)?(v(),x(l,{key:0,disabled:!F(q).length,type:"primary",status:"danger",onClick:le},{icon:g(()=>[h(S)]),_:1},8,["disabled"])):I("",!0),h(l,{type:"primary",onClick:a[0]||(a[0]=e=>K.value=!F(K))},{icon:g(()=>[h(P)]),default:g(()=>[y(j(F(K)?"取消批量":"批量操作"),1)]),_:1}),h(G,null,{default:g(()=>[h(L,{content:"传输列表",position:"bottom"},{default:g(()=>[h(l,null,{icon:g(()=>[h(A)]),_:1})]),_:1}),h(L,{content:"排序",position:"bottom"},{default:g(()=>[h(l,null,{icon:g(()=>[h(B)]),_:1})]),_:1}),h(L,{content:"视图",position:"bottom"},{default:g(()=>[h(l,{onClick:F($)},{icon:g(()=>["grid"===F(R)?(v(),x(O,{key:0})):(v(),x(V,{key:1}))]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1}),h(H,{class:"file-main__list",loading:F(J)},{default:g(()=>[M(h(U,{data:F(Q),"is-batch-mode":F(K),"selected-file-ids":F(q),onClick:ee,onSelect:ae,onRightMenuClick:te},null,8,["data","is-batch-mode","selected-file-ids"]),[[T,F(Q).length&&"grid"===F(R)]]),M(h(F(n),{data:F(Q),"is-batch-mode":F(K),"selected-file-ids":F(q),onClick:ee,onSelect:ae,onRightMenuClick:te},null,8,["data","is-batch-mode","selected-file-ids"]),[[T,F(Q).length&&"list"===F(R)]]),M(h(Z,null,null,512),[[T,!F(Q).length]])]),_:1},8,["loading"])])}}}),[["__scopeId","data-v-bc62cae8"]]);export{D as default};
