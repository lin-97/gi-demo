import{_ as e}from"./index-geucYCmw.js";import{d as l,c as a,S as t,U as d,I as u,e as o,fo as n,f as s,a as i,o as r,h as m,D as c,w as p,j as f,b as h,G as V,X as v,Y as y,i as _,t as b,v as k,J as x}from"./index-TfpzvVHF.js";import{b as w}from"./menu-Cy9l0oKZ.js";import{u as g}from"./useResetReactive-6TTKur6Y.js";const U=l({__name:"AddMenuModal",props:{menus:{default:()=>[]}},emits:["save-success"],setup(l,{expose:U,emit:I}){const M=l,S=I,j=a((()=>{const e=JSON.parse(JSON.stringify(M.menus)),l=t(e,(e=>[1,2].includes(e.type)));return d.mapTree(l,(e=>({id:e.id,title:e.title,children:e.children})))})),T={xs:24,sm:24,md:12,lg:12,xl:12,xxl:12},q={xs:12,sm:12,md:8,lg:8,xl:8,xxl:8},A=u("formRef"),J=o(""),O=o(!1),R=a((()=>!!J.value)),C=a((()=>R.value?"编辑菜单":"新增菜单")),D=o(!1),[N,z]=g({type:1,icon:"",svgIcon:"",title:"",sort:0,status:1,path:"",component:"",keepAlive:!1,hidden:!0,parentId:"",redirect:"",breadcrumb:!0,showInTabs:!0,alwaysShow:!1,permission:""}),B=a((()=>n(N.path))),E={parentId:[{required:!0,message:"请选择上级菜单"}],title:[{required:!0,message:"请输入菜单标题"}],path:[{required:!0,message:"请输入路由路径"}],permission:[{required:!0,message:"请输入权限标识"}]},F=a((()=>{if([1,2].includes(N.type)){const{title:e,path:l}=E;return{title:e,path:l}}if(3===N.type){const{parentId:e,title:l,permission:a}=E;return{parentId:e,title:l,permission:a}}return{}})),G=()=>{var e;null==(e=A.value)||e.clearValidate()},H=()=>{var e;null==(e=A.value)||e.resetFields(),z()},P=async()=>{var e;try{if(await(null==(e=A.value)?void 0:e.validate()))return!1;return!!(await new Promise((e=>setTimeout((()=>e(!0)),300))))&&(x.success("模拟保存成功"),S("save-success"),!0)}catch{return!1}};return U({add:()=>{J.value="",O.value=!0},edit:async e=>{O.value=!0,J.value=e;const l=await w.getDetail({id:e});Object.assign(N,l.data),k(N.path)&&(D.value=!0)}}),(l,a)=>{const t=s("a-radio"),d=s("a-radio-group"),u=s("a-form-item"),o=s("a-tree-select"),n=e,k=s("icon-question-circle-fill"),x=s("a-tooltip"),w=s("a-col"),g=s("a-row"),U=s("a-input"),I=s("a-tag"),M=s("a-switch"),S=s("a-input-number"),J=s("a-form"),z=s("a-modal");return r(),i(z,{visible:m(O),"onUpdate:visible":a[18]||(a[18]=e=>c(O)?O.value=e:null),title:m(C),width:"90%","modal-style":{maxWidth:"625px"},"body-style":{maxHeight:"70vh"},"mask-closable":!1,onBeforeOk:P,onClose:H},{default:p((()=>[f(J,{ref_key:"formRef",ref:A,model:m(N),rules:m(F),"auto-label-width":""},{default:p((()=>[f(u,{label:"菜单类型",field:"type"},{default:p((()=>[f(d,{modelValue:m(N).type,"onUpdate:modelValue":a[0]||(a[0]=e=>m(N).type=e),type:"button",disabled:m(R),onChange:G},{default:p((()=>[f(t,{value:1},{default:p((()=>a[19]||(a[19]=[V("目录")]))),_:1,__:[19]}),f(t,{value:2},{default:p((()=>a[20]||(a[20]=[V("菜单")]))),_:1,__:[20]}),f(t,{value:3},{default:p((()=>a[21]||(a[21]=[V("按钮")]))),_:1,__:[21]})])),_:1},8,["modelValue","disabled"])])),_:1}),f(u,{label:"上级菜单",field:"parentId"},{default:p((()=>[f(o,{modelValue:m(N).parentId,"onUpdate:modelValue":a[1]||(a[1]=e=>m(N).parentId=e),placeholder:"请选择上级菜单","allow-clear":"","allow-search":"",disabled:m(R),data:m(j),"field-names":{key:"id",title:"title",children:"children"}},null,8,["modelValue","disabled","data"])])),_:1}),[1,2].includes(m(N).type)?(r(),i(g,{key:0,gutter:16},{default:p((()=>[f(w,v(y(T)),{default:p((()=>[f(u,{label:"自定义图标",field:"svgIcon"},{default:p((()=>[f(n,{modelValue:m(N).svgIcon,"onUpdate:modelValue":a[2]||(a[2]=e=>m(N).svgIcon=e),type:"custom"},null,8,["modelValue"]),f(x,{content:"优先显示"},{default:p((()=>[f(k,{size:18,style:{color:"rgba(var(--warning-6))","margin-left":"8px"}})])),_:1})])),_:1})])),_:1},16),f(w,v(y(T)),{default:p((()=>[f(u,{label:"菜单图标",field:"icon"},{default:p((()=>[f(n,{modelValue:m(N).icon,"onUpdate:modelValue":a[3]||(a[3]=e=>m(N).icon=e)},null,8,["modelValue"])])),_:1})])),_:1},16)])),_:1})):h("",!0),f(u,{label:"菜单标题",field:"title"},{default:p((()=>[f(U,{modelValue:m(N).title,"onUpdate:modelValue":a[4]||(a[4]=e=>m(N).title=e),modelModifiers:{trim:!0},placeholder:"请输入菜单标题","allow-clear":"","max-length":10},null,8,["modelValue"])])),_:1}),[1,2].includes(m(N).type)?(r(),i(u,{key:1,label:"路由路径",field:"path"},{extra:p((()=>[_("div",null,[a[22]||(a[22]=_("span",null,"路由名称由系统自动生成：",-1)),m(B)?(r(),i(I,{key:0},{default:p((()=>[V(b(m(B)),1)])),_:1})):h("",!0)])])),default:p((()=>[f(U,{modelValue:m(N).path,"onUpdate:modelValue":a[5]||(a[5]=e=>m(N).path=e),modelModifiers:{trim:!0},placeholder:"请输入路由路径","allow-clear":"","max-length":50},null,8,["modelValue"])])),_:1})):h("",!0),[1,2].includes(m(N).type)&&!m(D)?(r(),i(u,{key:2,label:"重定向",field:"redirect"},{default:p((()=>[f(U,{modelValue:m(N).redirect,"onUpdate:modelValue":a[6]||(a[6]=e=>m(N).redirect=e),modelModifiers:{trim:!0},placeholder:"请输入重定向地址","allow-clear":"","max-length":50},null,8,["modelValue"])])),_:1})):h("",!0),[1,2].includes(m(N).type)?(r(),i(u,{key:3,label:"是否外链",field:"isExternalUrl"},{default:p((()=>[f(d,{modelValue:m(D),"onUpdate:modelValue":a[7]||(a[7]=e=>c(D)?D.value=e:null),type:"button"},{default:p((()=>[f(t,{value:!0},{default:p((()=>a[23]||(a[23]=[V("是")]))),_:1,__:[23]}),f(t,{value:!1},{default:p((()=>a[24]||(a[24]=[V("否")]))),_:1,__:[24]})])),_:1},8,["modelValue"])])),_:1})):h("",!0),2===m(N).type?(r(),i(u,{key:4,label:"组件路径",field:"component"},{default:p((()=>[m(D)?(r(),i(U,{key:0,modelValue:m(N).component,"onUpdate:modelValue":a[8]||(a[8]=e=>m(N).component=e),modelModifiers:{trim:!0},placeholder:"请输入组件路径","allow-clear":"","max-length":50},null,8,["modelValue"])):(r(),i(U,{key:1,modelValue:m(N).component,"onUpdate:modelValue":a[9]||(a[9]=e=>m(N).component=e),modelModifiers:{trim:!0},placeholder:"请输入组件路径","allow-clear":"","max-length":50},{prepend:p((()=>a[25]||(a[25]=[V("@/views/")]))),append:p((()=>a[26]||(a[26]=[V(".vue")]))),_:1},8,["modelValue"]))])),_:1})):h("",!0),[1,2].includes(m(N).type)?(r(),i(g,{key:5,gutter:16},{default:p((()=>[f(w,v(y(q)),{default:p((()=>[f(u,{label:"状态",field:"status"},{default:p((()=>[f(M,{modelValue:m(N).status,"onUpdate:modelValue":a[10]||(a[10]=e=>m(N).status=e),type:"round","checked-value":1,"unchecked-value":0,"checked-text":"启用","unchecked-text":"禁用"},null,8,["modelValue"])])),_:1})])),_:1},16),f(w,v(y(q)),{default:p((()=>[f(u,{label:"是否隐藏",field:"hidden"},{default:p((()=>[f(M,{modelValue:m(N).hidden,"onUpdate:modelValue":a[11]||(a[11]=e=>m(N).hidden=e),type:"round","checked-value":!0,"unchecked-value":!1,"checked-text":"是","unchecked-text":"否"},null,8,["modelValue"])])),_:1})])),_:1},16),f(w,v(y(q)),{default:p((()=>[f(u,{label:"是否缓存",field:"keepAlive"},{default:p((()=>[f(M,{modelValue:m(N).keepAlive,"onUpdate:modelValue":a[12]||(a[12]=e=>m(N).keepAlive=e),type:"round","checked-value":!0,"unchecked-value":!1,"checked-text":"是","unchecked-text":"否"},null,8,["modelValue"])])),_:1})])),_:1},16),f(w,v(y(q)),{default:p((()=>[f(u,{label:"面包屑",field:"breadcrumb"},{default:p((()=>[f(M,{modelValue:m(N).breadcrumb,"onUpdate:modelValue":a[13]||(a[13]=e=>m(N).breadcrumb=e),type:"round","checked-value":!0,"unchecked-value":!1,"checked-text":"显示","unchecked-text":"隐藏"},null,8,["modelValue"])])),_:1})])),_:1},16),f(w,v(y(q)),{default:p((()=>[1===m(N).type?(r(),i(u,{key:0,label:"总是显示",field:"alwaysShow"},{default:p((()=>[f(M,{modelValue:m(N).alwaysShow,"onUpdate:modelValue":a[14]||(a[14]=e=>m(N).alwaysShow=e),type:"round","checked-value":!0,"unchecked-value":!1,"checked-text":"显示","unchecked-text":"隐藏"},null,8,["modelValue"])])),_:1})):h("",!0),2===m(N).type?(r(),i(u,{key:1,label:"页签显示",field:"showInTabs"},{default:p((()=>[f(M,{modelValue:m(N).showInTabs,"onUpdate:modelValue":a[15]||(a[15]=e=>m(N).showInTabs=e),type:"round","checked-value":!0,"unchecked-value":!1,"checked-text":"显示","unchecked-text":"隐藏"},null,8,["modelValue"])])),_:1})):h("",!0)])),_:1},16)])),_:1})):h("",!0),3===m(N).type?(r(),i(u,{key:6,label:"权限标识",field:"permission"},{default:p((()=>[f(U,{modelValue:m(N).permission,"onUpdate:modelValue":a[16]||(a[16]=e=>m(N).permission=e),modelModifiers:{trim:!0},placeholder:"sys:btn:add","allow-clear":"","max-length":20},null,8,["modelValue"])])),_:1})):h("",!0),f(u,{label:"菜单排序",field:"sort"},{default:p((()=>[f(S,{modelValue:m(N).sort,"onUpdate:modelValue":a[17]||(a[17]=e=>m(N).sort=e),placeholder:"请输入菜单排序",min:1,mode:"button",style:{width:"120px"}},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["visible","title"])}}});export{U as _};
