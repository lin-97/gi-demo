import{_ as e}from"./index-Dzl5urLf.js";import{_ as t}from"./GiCellStatus.vue_vue_type_script_setup_true_lang-BCwoOWHD.js";import{u as n}from"./index-CWsJrtG_.js";import a from"./index-DIMcoueJ.js";import{d as o,s as l,L as i,V as s,a7 as r,f as c,a as p,o as d,w as u,j as m,G as b,h as f,t as g,J as y,a8 as w,Z as h}from"./index-CaTNYhxh.js";import{u as _}from"./useTable-DzfxcQ6X.js";import{b as k}from"./index-7eUj0KQm.js";import"./dept-BtlGnOEc.js";import"./role-BwDBVdZ2.js";import{u as x}from"./useDict-DE_97KF8.js";import{_ as C}from"./index-DYjg1Rxd.js";const D=o({__name:"Pane1",setup(o){const{width:D}=n(),T=l(),{setTabTitle:v}=i(),{data:j}=x({code:"status"}),A=s({name:"",status:""}),{loading:I,tableData:S,getTableData:V,pagination:P,selectedKeys:G,select:z,selectAll:M,handleDelete:L,fixed:E}=_(e=>k.getList({...A,...e}),{immediate:!1,formatResult:e=>e.map(e=>({...e,isEdit:!1}))});r(()=>{V()});const K=()=>{T.push({path:"/data/form"})},J=async()=>{await T.push({path:"/data/form",query:{id:"ID123456"}}),v("编辑")},W=()=>{if(!G.value.length)return y.warning("请选择删除项！");L(()=>k.delete({ids:G.value}),{successTip:"批量删除成功！"})},R=()=>{if(!G.value.length)return y.warning("请勾选数据");y.success("点击了导出")},q=()=>{w.open({title:"查看代码",content:()=>h(C,{codeJson:'\n<template>\n  <GiPageLayout>\n    <template #left>\n      <CateTree placeholder="请输入搜索关键词" @node-click="pagination.onChange(1)"></CateTree>\n    </template>\n\n    <a-row justify="space-between">\n      <a-space wrap>\n        <a-button type="primary" @click="onAdd">\n          <template #icon><icon-plus /></template>\n        </a-button>\n        <a-button type="primary" status="danger" @click="onMulDelete">\n          <template #icon><icon-delete /></template>\n          <template #default>删除</template>\n        </a-button>\n        <a-button type="primary" status="success" @click="onExport">\n          <template #icon><icon-export /></template>\n        </a-button>\n        <a-button type="primary" status="warning" @click="onViewCode">\n          <template #icon><icon-code /></template>\n        </a-button>\n      </a-space>\n\n      <a-space wrap>\n        <a-select v-model="form.status" class="gi_select_input" :options="options" placeholder="请选择"\n          allow-clear></a-select>\n        <a-input-group>\n          <a-input v-model="form.name" placeholder="请输入搜索关键词" allow-clear> </a-input>\n          <a-button type="primary" @click="getTableData">\n            <icon-search />\n          </a-button>\n        </a-input-group>\n        <a-button type="primary" @click="getTableData">\n          <template #icon><icon-refresh /></template>\n        </a-button>\n      </a-space>\n    </a-row>\n\n    <a-table class="gi_table" row-key="id" :loading="loading" :bordered="{ cell: true }" :data="tableData"\n      :scroll="{ x: \'100%\', y: \'100%\', minWidth: 1000 }" :row-selection="{ type: \'checkbox\', showCheckedAll: true }"\n      :pagination="pagination" :selected-keys="selectedKeys" @select="select" @select-all="selectAll">\n      <template #columns>\n        <a-table-column title="序号" :width="68">\n          <template #cell="cell">{{ cell.rowIndex + 1 }}</template>\n        </a-table-column>\n        <a-table-column title="姓名" data-index="name"></a-table-column>\n        <a-table-column title="地址" data-index="address" ellipsis tooltip></a-table-column>\n        <a-table-column title="比例" :width="200">\n          <template #cell="{ record }">\n            <a-progress :status="getProportionColor(record.proportion)" :percent="record.proportion / 100" />\n          </template>\n        </a-table-column>\n        <a-table-column title="状态" :width="100" align="center">\n          <template #cell="{ record }">\n            <GiCellStatus :status="record.status"></GiCellStatus>\n          </template>\n        </a-table-column>\n        <a-table-column title="创建时间" data-index="createTime" :width="180"></a-table-column>\n        <a-table-column title="操作" :width="200" align="center" :fixed="fixed">\n          <template #cell="{ record }">\n            <a-space>\n              <a-button type="primary" size="mini" @click="onEdit">修改</a-button>\n              <a-button size="mini" @click="onDetail(record)">详情</a-button>\n              <a-popconfirm type="warning" content="您确定要删除该项吗?" @before-ok="onDelete(record)">\n                <a-button type="primary" status="danger" size="mini">删除</a-button>\n              </a-popconfirm>\n            </a-space>\n          </template>\n        </a-table-column>\n      </template>\n    </a-table>\n  </GiPageLayout>\n</template>\n\n<script setup lang="ts">\nimport { Drawer, Message } from \'@arco-design/web-vue\'\nimport { useWindowSize } from \'@vueuse/core\'\nimport CateTree from \'./CateTree/index.vue\'\nimport Pane1Json from \'./code/pane1-json\'\nimport { useTable } from \'@/hooks\'\nimport { baseAPI } from \'@/apis/person\'\nimport type * as T from \'@/apis/person\'\nimport { useDict } from \'@/hooks/app\'\nimport GiCodeView from \'@/components/GiCodeView/index.vue\'\nimport { useTabsStore } from \'@/stores\'\n\nconst { width } = useWindowSize()\nconst router = useRouter()\nconst { setTabTitle } = useTabsStore()\n\nconst { data: options } = useDict({ code: \'status\' })\nconst form = reactive({\n  name: \'\',\n  status: \'\'\n})\n\n// 这里使用了表格hooks：useTable, 节省了大量代码\nconst { loading, tableData, getTableData, pagination, selectedKeys, select, selectAll, handleDelete, fixed } = useTable(\n  (page) => baseAPI.getList({ ...form, ...page }),\n  { immediate: false, formatResult: (data) => data.map((i) => ({ ...i, isEdit: false })) }\n)\n\n// 比例进度条颜色\nconst getProportionColor = (proportion: number) => {\n  if (proportion < 30) return \'danger\'\n  if (proportion < 60) return \'warning\'\n  return \'success\'\n}\n\nonActivated(() => {\n  getTableData()\n})\n\nconst onAdd = () => {\n  router.push({ path: \'/data/form\' })\n}\n\nconst onEdit = async () => {\n  await router.push({ path: \'/data/form\', query: { id: \'ID123456\' } })\n  setTabTitle(\'编辑\')\n}\n\nconst onDetail = (item: T.ListItem) => {\n  router.push({ name: \'DataDetailId\', params: { id: item.id } })\n}\n\n// 删除\nconst onDelete = (item: T.ListItem) => {\n  return handleDelete(() => baseAPI.delete({ ids: [item.id] }), { content: `是否删除-${item.name}?`, showModal: false })\n}\n\n// 批量删除\nconst onMulDelete = () => {\n  if (!selectedKeys.value.length) {\n    return Message.warning(\'请选择删除项！\')\n  }\n  handleDelete(() => baseAPI.delete({ ids: selectedKeys.value as string[] }), { successTip: \'批量删除成功！\' })\n}\n\nconst onExport = () => {\n  if (!selectedKeys.value.length) {\n    return Message.warning(\'请勾选数据\')\n  }\n  Message.success(\'点击了导出\')\n}\n\nconst onViewCode = () => {\n  Drawer.open({\n    title: \'查看代码\',\n    content: () => h(GiCodeView, { codeJson: Pane1Json, type: \'vue\' }),\n    width: width.value < 500 ? \'100%\' : 800\n  })\n}\n<\/script>\n\n<style lang="scss" scoped></style>\n',type:"vue"}),width:D.value<500?"100%":800})};return(n,o)=>{const l=c("icon-plus"),i=c("a-button"),s=c("icon-delete"),r=c("icon-export"),y=c("icon-code"),w=c("a-space"),h=c("a-select"),_=c("a-input"),x=c("icon-search"),C=c("a-input-group"),D=c("icon-refresh"),v=c("a-row"),B=c("a-table-column"),O=c("a-progress"),U=t,$=c("a-popconfirm"),N=c("a-table"),Z=e;return d(),p(Z,null,{left:u(()=>[m(a,{placeholder:"请输入搜索关键词",onNodeClick:o[0]||(o[0]=e=>f(P).onChange(1))})]),default:u(()=>[m(v,{justify:"space-between"},{default:u(()=>[m(w,{wrap:""},{default:u(()=>[m(i,{type:"primary",onClick:K},{icon:u(()=>[m(l)]),_:1}),m(i,{type:"primary",status:"danger",onClick:W},{icon:u(()=>[m(s)]),default:u(()=>o[3]||(o[3]=[b("删除",-1)])),_:1}),m(i,{type:"primary",status:"success",onClick:R},{icon:u(()=>[m(r)]),_:1}),m(i,{type:"primary",status:"warning",onClick:q},{icon:u(()=>[m(y)]),_:1})]),_:1}),m(w,{wrap:""},{default:u(()=>[m(h,{modelValue:f(A).status,"onUpdate:modelValue":o[1]||(o[1]=e=>f(A).status=e),class:"gi_select_input",options:f(j),placeholder:"请选择","allow-clear":""},null,8,["modelValue","options"]),m(C,null,{default:u(()=>[m(_,{modelValue:f(A).name,"onUpdate:modelValue":o[2]||(o[2]=e=>f(A).name=e),placeholder:"请输入搜索关键词","allow-clear":""},null,8,["modelValue"]),m(i,{type:"primary",onClick:f(V)},{default:u(()=>[m(x)]),_:1},8,["onClick"])]),_:1}),m(i,{type:"primary",onClick:f(V)},{icon:u(()=>[m(D)]),_:1},8,["onClick"])]),_:1})]),_:1}),m(N,{class:"gi_table","row-key":"id",loading:f(I),bordered:{cell:!0},data:f(S),scroll:{x:"100%",y:"100%",minWidth:1e3},"row-selection":{type:"checkbox",showCheckedAll:!0},pagination:f(P),"selected-keys":f(G),onSelect:f(z),onSelectAll:f(M)},{columns:u(()=>[m(B,{title:"序号",width:68},{cell:u(e=>[b(g(e.rowIndex+1),1)]),_:1}),m(B,{title:"姓名","data-index":"name"}),m(B,{title:"地址","data-index":"address",ellipsis:"",tooltip:""}),m(B,{title:"比例",width:200},{cell:u(({record:e})=>{return[m(O,{status:(t=e.proportion,t<30?"danger":t<60?"warning":"success"),percent:e.proportion/100},null,8,["status","percent"])];var t}),_:1}),m(B,{title:"状态",width:100,align:"center"},{cell:u(({record:e})=>[m(U,{status:e.status},null,8,["status"])]),_:1}),m(B,{title:"创建时间","data-index":"createTime",width:180}),m(B,{title:"操作",width:200,align:"center",fixed:f(E)},{cell:u(({record:e})=>[m(w,null,{default:u(()=>[m(i,{type:"primary",size:"mini",onClick:J},{default:u(()=>o[4]||(o[4]=[b("修改",-1)])),_:1,__:[4]}),m(i,{size:"mini",onClick:t=>{return n=e,void T.push({name:"DataDetailId",params:{id:n.id}});var n}},{default:u(()=>o[5]||(o[5]=[b("详情",-1)])),_:2,__:[5]},1032,["onClick"]),m($,{type:"warning",content:"您确定要删除该项吗?",onBeforeOk:t=>{return L(()=>k.delete({ids:[n.id]}),{content:`是否删除-${(n=e).name}?`,showModal:!1});var n}},{default:u(()=>[m(i,{type:"primary",status:"danger",size:"mini"},{default:u(()=>o[6]||(o[6]=[b("删除",-1)])),_:1,__:[6]})]),_:2},1032,["onBeforeOk"])]),_:2},1024)]),_:1},8,["fixed"])]),_:1},8,["loading","data","pagination","selected-keys","onSelect","onSelectAll"])]),_:1})}}});export{D as _};
