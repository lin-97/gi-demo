import{_ as e}from"./index-C3KQkfm5.js";import{_ as t}from"./GiCellStatus.vue_vue_type_script_setup_true_lang-CvKQxN1l.js";import{u as n}from"./index-C0BHoBNC.js";import a from"./index-CMOwq-eq.js";import{d as l,n as o,S as i,a6 as s,f as r,o as c,a as d,w as p,i as u,h as m,D as g,t as f,M as y,a7 as b,a4 as h}from"./index-BSX7bYGM.js";import{u as w}from"./useTable-BxLsCQaB.js";import{d as _,g as x}from"./index-47PwsTpQ.js";import{u as k}from"./useDict-BX-MLngn.js";import{_ as D}from"./index-CBhxnfvI.js";const C=l({__name:"Pane1",setup(l){const{width:C}=n(),v=o(),{data:T}=k({code:"status"}),P=i({name:"",status:""}),{loading:j,tableData:V,getTableData:S,pagination:I,selectedKeys:M,select:z,selectAll:A,handleDelete:G,fixed:E}=w((e=>x({...P,...e})),{immediate:!1,formatResult:e=>e.map((e=>({...e,isEdit:!1})))});s((()=>{S()}));const K=()=>{v.push({path:"/data/form",query:{id:"ID123456"}})},W=()=>{if(!M.value.length)return y.warning("请选择删除项！");G((()=>_({ids:M.value})),{successTip:"批量删除成功！"})},J=()=>{if(!M.value.length)return y.warning("请勾选数据");y.success("点击了导出")},L=()=>{b.open({title:"数据结构",content:()=>h(D,{codeJson:'\n<template>\n  <GiPageLayout>\n    <template #left>\n      <a-card title="数据分类" :bordered="false" :header-style="{ display: \'none\' }" class="gi_card flex-1">\n        <CateTree placeholder="请输入搜索关键词" @node-click="pagination.onChange(1)"></CateTree>\n      </a-card>\n    </template>\n\n    <a-card title="数据列表" :bordered="false" :header-style="{ display: \'none\' }" class="gi_card flex-1">\n      <a-row justify="space-between">\n        <a-space wrap>\n          <a-button type="primary">\n            <template #icon><icon-plus /></template>\n          </a-button>\n          <a-button type="primary" status="danger" @click="onMulDelete">\n            <template #icon><icon-delete /></template>\n            <template #default>删除</template>\n          </a-button>\n          <a-button type="primary" status="success" @click="onExport">\n            <template #icon><icon-export /></template>\n          </a-button>\n          <a-button type="primary" status="warning" @click="onViewCode">\n            <template #icon><icon-code /></template>\n          </a-button>\n        </a-space>\n\n        <a-space wrap>\n          <a-select v-model="form.status" class="gi_select_input" :options="options" placeholder="请选择"\n            allow-clear></a-select>\n          <a-input-group>\n            <a-input v-model="form.name" placeholder="请输入搜索关键词" allow-clear> </a-input>\n            <a-button type="primary" @click="getTableData">\n              <icon-search />\n            </a-button>\n          </a-input-group>\n          <a-button type="primary" @click="getTableData">\n            <template #icon><icon-refresh /></template>\n          </a-button>\n        </a-space>\n      </a-row>\n\n      <a-table class="gi_table" row-key="id" :loading="loading" :bordered="{ cell: true }" :data="tableData"\n        :scroll="{ x: \'100%\', y: \'100%\', minWidth: 1000 }" :row-selection="{ type: \'checkbox\', showCheckedAll: true }"\n        :pagination="pagination" :selected-keys="selectedKeys" @select="select" @select-all="selectAll">\n        <template #columns>\n          <a-table-column title="序号" :width="68">\n            <template #cell="cell">{{ cell.rowIndex + 1 }}</template>\n          </a-table-column>\n          <a-table-column title="姓名" data-index="name"></a-table-column>\n          <a-table-column title="地址" data-index="address" ellipsis tooltip></a-table-column>\n          <a-table-column title="比例" :width="200">\n            <template #cell="{ record }">\n              <a-progress :status="getProportionColor(record.proportion)" :percent="record.proportion / 100" />\n            </template>\n          </a-table-column>\n          <a-table-column title="状态" :width="100" align="center">\n            <template #cell="{ record }">\n              <GiCellStatus :status="record.status"></GiCellStatus>\n            </template>\n          </a-table-column>\n          <a-table-column title="创建时间" data-index="createTime" :width="180"></a-table-column>\n          <a-table-column title="操作" :width="200" align="center" :fixed="fixed">\n            <template #cell="{ record }">\n              <a-space>\n                <a-button type="primary" size="mini" @click="onEdit">修改</a-button>\n                <a-button size="mini" @click="onDetail(record)">详情</a-button>\n                <a-popconfirm type="warning" content="您确定要删除该项吗?" @before-ok="onDelete(record)">\n                  <a-button type="primary" status="danger" size="mini">删除</a-button>\n                </a-popconfirm>\n              </a-space>\n            </template>\n          </a-table-column>\n        </template>\n      </a-table>\n    </a-card>\n  </GiPageLayout>\n</template>\n\n<script setup lang="ts">\nimport { Drawer, Message } from \'@arco-design/web-vue\'\nimport { useWindowSize } from \'@vueuse/core\'\nimport CateTree from \'./CateTree/index.vue\'\nimport Pane1Json from \'./code/pane1-json\'\nimport { useTable } from \'@/hooks\'\nimport { type PersonItem, deletePerson, getPersonList } from \'@/apis/person\'\nimport { useDict } from \'@/hooks/app\'\nimport GiCodeView from \'@/components/GiCodeView/index.vue\'\n\nconst { width } = useWindowSize()\nconst router = useRouter()\n\nconst { data: options } = useDict({ code: \'status\' })\nconst form = reactive({\n  name: \'\',\n  status: \'\'\n})\n\n// 这里使用了表格hooks：useTable, 节省了大量代码\nconst { loading, tableData, getTableData, pagination, selectedKeys, select, selectAll, handleDelete, fixed } = useTable(\n  (page) => getPersonList({ ...form, ...page }),\n  { immediate: false, formatResult: (data) => data.map((i) => ({ ...i, isEdit: false })) }\n)\n\n// 比例进度条颜色\nconst getProportionColor = (proportion: number) => {\n  if (proportion < 30) return \'danger\'\n  if (proportion < 60) return \'warning\'\n  return \'success\'\n}\n\nonActivated(() => {\n  getTableData()\n})\n\nconst onEdit = () => {\n  router.push({ path: \'/data/form\', query: { id: \'ID123456\' } })\n}\n\nconst onDetail = (item: PersonItem) => {\n  router.push({ name: \'DataDetailId\', params: { id: item.id } })\n}\n\n// 删除\nconst onDelete = (item: PersonItem) => {\n  return handleDelete(() => deletePerson({ ids: [item.id] }), { content: `是否删除-${item.name}?`, showModal: false })\n}\n\n// 批量删除\nconst onMulDelete = () => {\n  if (!selectedKeys.value.length) {\n    return Message.warning(\'请选择删除项！\')\n  }\n  handleDelete(() => deletePerson({ ids: selectedKeys.value as string[] }), { successTip: \'批量删除成功！\' })\n}\n\nconst onExport = () => {\n  if (!selectedKeys.value.length) {\n    return Message.warning(\'请勾选数据\')\n  }\n  Message.success(\'点击了导出\')\n}\n\nconst onViewCode = () => {\n  Drawer.open({\n    title: \'数据结构\',\n    content: () => h(GiCodeView, { codeJson: Pane1Json, type: \'vue\' }),\n    width: width.value < 500 ? \'100%\' : 800\n  })\n}\n<\/script>\n\n<style lang="scss" scoped></style>\n',type:"vue"}),width:C.value<500?"100%":800})};return(n,l)=>{const o=r("a-card"),i=r("icon-plus"),s=r("a-button"),y=r("icon-delete"),b=r("icon-export"),h=r("icon-code"),w=r("a-space"),x=r("a-select"),k=r("a-input"),D=r("icon-search"),C=r("a-input-group"),R=r("icon-refresh"),q=r("a-row"),B=r("a-table-column"),O=r("a-progress"),U=t,$=r("a-popconfirm"),N=r("a-table"),F=e;return c(),d(F,null,{left:p((()=>[u(o,{title:"数据分类",bordered:!1,"header-style":{display:"none"},class:"gi_card flex-1"},{default:p((()=>[u(a,{placeholder:"请输入搜索关键词",onNodeClick:l[0]||(l[0]=e=>m(I).onChange(1))})])),_:1})])),default:p((()=>[u(o,{title:"数据列表",bordered:!1,"header-style":{display:"none"},class:"gi_card flex-1"},{default:p((()=>[u(q,{justify:"space-between"},{default:p((()=>[u(w,{wrap:""},{default:p((()=>[u(s,{type:"primary"},{icon:p((()=>[u(i)])),_:1}),u(s,{type:"primary",status:"danger",onClick:W},{icon:p((()=>[u(y)])),default:p((()=>l[3]||(l[3]=[g("删除")]))),_:1}),u(s,{type:"primary",status:"success",onClick:J},{icon:p((()=>[u(b)])),_:1}),u(s,{type:"primary",status:"warning",onClick:L},{icon:p((()=>[u(h)])),_:1})])),_:1}),u(w,{wrap:""},{default:p((()=>[u(x,{modelValue:m(P).status,"onUpdate:modelValue":l[1]||(l[1]=e=>m(P).status=e),class:"gi_select_input",options:m(T),placeholder:"请选择","allow-clear":""},null,8,["modelValue","options"]),u(C,null,{default:p((()=>[u(k,{modelValue:m(P).name,"onUpdate:modelValue":l[2]||(l[2]=e=>m(P).name=e),placeholder:"请输入搜索关键词","allow-clear":""},null,8,["modelValue"]),u(s,{type:"primary",onClick:m(S)},{default:p((()=>[u(D)])),_:1},8,["onClick"])])),_:1}),u(s,{type:"primary",onClick:m(S)},{icon:p((()=>[u(R)])),_:1},8,["onClick"])])),_:1})])),_:1}),u(N,{class:"gi_table","row-key":"id",loading:m(j),bordered:{cell:!0},data:m(V),scroll:{x:"100%",y:"100%",minWidth:1e3},"row-selection":{type:"checkbox",showCheckedAll:!0},pagination:m(I),"selected-keys":m(M),onSelect:m(z),onSelectAll:m(A)},{columns:p((()=>[u(B,{title:"序号",width:68},{cell:p((e=>[g(f(e.rowIndex+1),1)])),_:1}),u(B,{title:"姓名","data-index":"name"}),u(B,{title:"地址","data-index":"address",ellipsis:"",tooltip:""}),u(B,{title:"比例",width:200},{cell:p((({record:e})=>{return[u(O,{status:(t=e.proportion,t<30?"danger":t<60?"warning":"success"),percent:e.proportion/100},null,8,["status","percent"])];var t})),_:1}),u(B,{title:"状态",width:100,align:"center"},{cell:p((({record:e})=>[u(U,{status:e.status},null,8,["status"])])),_:1}),u(B,{title:"创建时间","data-index":"createTime",width:180}),u(B,{title:"操作",width:200,align:"center",fixed:m(E)},{cell:p((({record:e})=>[u(w,null,{default:p((()=>[u(s,{type:"primary",size:"mini",onClick:K},{default:p((()=>l[4]||(l[4]=[g("修改")]))),_:1}),u(s,{size:"mini",onClick:t=>{return n=e,void v.push({name:"DataDetailId",params:{id:n.id}});var n}},{default:p((()=>l[5]||(l[5]=[g("详情")]))),_:2},1032,["onClick"]),u($,{type:"warning",content:"您确定要删除该项吗?",onBeforeOk:t=>{return G((()=>_({ids:[n.id]})),{content:`是否删除-${(n=e).name}?`,showModal:!1});var n}},{default:p((()=>[u(s,{type:"primary",status:"danger",size:"mini"},{default:p((()=>l[6]||(l[6]=[g("删除")]))),_:1})])),_:2},1032,["onBeforeOk"])])),_:2},1024)])),_:1},8,["fixed"])])),_:1},8,["loading","data","pagination","selected-keys","onSelect","onSelectAll"])])),_:1})])),_:1})}}});export{C as _};
