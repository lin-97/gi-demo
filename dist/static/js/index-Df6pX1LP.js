import{a8 as e,d as a,e as l,H as i,f as t,o as n,g as o,j as s,i as u,w as d,h as r,E as p,t as c,a as m,R as v,a5 as f,M as g,I as h,_}from"./index-DV9OlI_B.js";import V from"./RightMenu-BLmrUqKO.js";import{_ as x}from"./index-CjHPh1ll.js";function y(){return e.get("/cate/getCateTree")}const b={class:"cate-tree"},k={class:"cate-tree__search"},E={class:"cate-tree__tree"},w=["onContextmenu"],C=_(a({__name:"index",props:{type:{default:1},placeholder:{default:"请输入关键词"}},emits:["node-click"],setup(e,{emit:a}){const _=e,C=a,R=l(!1),z=i("treeRef"),M=l(""),U=l([]),j=()=>{C("node-click")};(async()=>{try{R.value=!0;const e=await y();U.value=v.mapTree(e.data,(e=>({...e,popupVisible:!1,isEdit:!1,icon:e=>e.expanded&&!e.isLeaf?u(x,{name:"file-open",size:16},null):e.expanded||e.isLeaf?u(x,{name:"file",size:16},null):u(x,{name:"file-close",size:16},null)}))),f((()=>{var e;null==(e=z.value)||e.expandAll()}))}finally{R.value=!1}})();const T=i("inputRef"),B=l(null),I=()=>{var e;(null==(e=B.value)?void 0:e.popupVisible)&&(B.value.popupVisible=!1)},O=e=>{var a,l;"move"!==e&&(g.info(`${e}-${(null==(a=B.value)?void 0:a.name)??""}`),I()),"edit"===e&&void 0!==(null==(l=B.value)?void 0:l.isEdit)&&(B.value.isEdit=!0,f((()=>{var e;null==(e=T.value)||e.focus()}))),"delete"===e&&h.warning({title:"提示",content:"是否确认删除？",hideCancel:!1,okButtonProps:{status:"danger"},onBeforeOk:()=>new Promise((e=>setTimeout((()=>e(!0)),300)))})},L=e=>{g.info(e.name),I()},P=()=>{var e;(null==(e=B.value)?void 0:e.isEdit)&&(B.value.isEdit=!1),y()};return(e,a)=>{const l=t("icon-search"),i=t("a-input"),v=t("a-trigger"),f=t("a-tree"),g=t("a-scrollbar");return n(),o("div",b,[s("div",k,[u(i,{modelValue:r(M),"onUpdate:modelValue":a[0]||(a[0]=e=>p(M)?M.value=e:null),"allow-clear":"",maxlength:20,placeholder:_.placeholder},{prefix:d((()=>[u(l)])),_:1},8,["modelValue","placeholder"])]),s("div",E,[u(g,{style:{height:"100%",overflow:"auto"},"outer-style":"height: 100%"},{default:d((()=>[u(f,{ref_key:"treeRef",ref:z,"show-line":"",size:"mini",data:r(U),"field-names":{key:"id"},onSelect:j},{title:d((e=>[u(v,{"popup-visible":e.popupVisible,"onUpdate:popupVisible":a=>e.popupVisible=a,trigger:"contextMenu","align-point":"","animation-name":"slide-dynamic-origin","auto-fit-transform-origin":"",position:"bl","scroll-to-close":""},{content:d((()=>[u(V,{"tree-data":r(U),onOnMenuItemClick:O,onOnTreeNodeClick:L},null,8,["tree-data"])])),default:d((()=>[e.isEdit?(n(),m(i,{key:1,ref_key:"inputRef",ref:T,modelValue:e.name,"onUpdate:modelValue":a=>e.name=a,size:"mini",placeholder:"请填写",onBlur:P},null,8,["modelValue","onUpdate:modelValue"])):(n(),o("div",{key:0,onContextmenu:a=>(e=>{var a;void 0!==(null==(a=B.value)?void 0:a.isEdit)&&(B.value.isEdit=!1),B.value=e})(e)},c(e.name),41,w))])),_:2},1032,["popup-visible","onUpdate:popupVisible"])])),_:1},8,["data"])])),_:1})])])}}}),[["__scopeId","data-v-33ed8487"]]);export{C as default};
