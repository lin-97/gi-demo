import{b as e}from"./role-BwDBVdZ2.js";import{d as a,I as l,e as s,c as t,f as d,a as o,o as i,h as u,D as m,w as r,j as n,J as c}from"./index-CaTNYhxh.js";import{u as f}from"./useResetReactive-CVrmH7v1.js";const p=a({__name:"AddRoleModal",emits:["save-success"],setup(a,{expose:p,emit:v}){const h=v,w=l("formRef"),b=s(""),x=t(()=>!!b.value),V=t(()=>x.value?"编辑角色":"新增角色"),_=s(!1),[g,k]=f({name:"",code:"",status:1,description:""}),R={name:[{required:!0,message:"请输入角色名称"},{min:3,max:10,message:"长度在 3 - 10个字符"}],code:[{required:!0,message:"请输入角色编码"},{match:/^[a-z]\w*$/i,message:"格式不对！只能英文开头，包含英文数字下划线"}],status:[{required:!0}]},y=()=>{var e;null==(e=w.value)||e.resetFields(),k()},j=async()=>{var e;try{if(await(null==(e=w.value)?void 0:e.validate()))return!1;return!!(await new Promise(e=>setTimeout(()=>e(!0),300)))&&(c.success("模拟保存成功"),h("save-success"),!0)}catch{return!1}};return p({add:()=>{b.value="",_.value=!0},edit:async a=>{_.value=!0,b.value=a;const l=await e.getDetail({id:a});Object.assign(g,l.data)}}),(e,a)=>{const l=d("a-input"),s=d("a-form-item"),t=d("a-textarea"),c=d("a-switch"),f=d("a-form"),p=d("a-modal");return i(),o(p,{visible:u(_),"onUpdate:visible":a[4]||(a[4]=e=>m(_)?_.value=e:null),title:u(V),width:"90%","mask-closable":!1,"modal-style":{maxWidth:"520px"},onBeforeOk:j,onClose:y},{default:r(()=>[n(f,{ref_key:"formRef",ref:w,model:u(g),rules:R,size:"medium","auto-label-width":""},{default:r(()=>[n(s,{label:"角色名称",field:"name"},{default:r(()=>[n(l,{modelValue:u(g).name,"onUpdate:modelValue":a[0]||(a[0]=e=>u(g).name=e),modelModifiers:{trim:!0},placeholder:"请输入角色名称","allow-clear":"","max-length":10},null,8,["modelValue"])]),_:1}),n(s,{label:"角色编码",field:"code"},{default:r(()=>[n(l,{modelValue:u(g).code,"onUpdate:modelValue":a[1]||(a[1]=e=>u(g).code=e),modelModifiers:{trim:!0},placeholder:"请输入角色编码","allow-clear":"",disabled:u(x),"max-length":10},null,8,["modelValue","disabled"])]),_:1}),n(s,{label:"描述",field:"description"},{default:r(()=>[n(t,{modelValue:u(g).description,"onUpdate:modelValue":a[2]||(a[2]=e=>u(g).description=e),modelModifiers:{trim:!0},placeholder:"请填写描述","max-length":200,"show-word-limit":"","auto-size":{minRows:3,maxRows:5}},null,8,["modelValue"])]),_:1}),n(s,{label:"状态",field:"status"},{default:r(()=>[n(c,{modelValue:u(g).status,"onUpdate:modelValue":a[3]||(a[3]=e=>u(g).status=e),type:"round","checked-value":1,"unchecked-value":0,"checked-text":"正常","unchecked-text":"禁用"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible","title"])}}});export{p as _};
