import{d as e,e as a,I as l,f as i,o as t,g as o,j as n,i as s,w as d,h as u,E as r,t as p,a as m,U as c,a6 as v,M as f,J as h,_}from"./index-BJbUSEMT.js";import g from"./RightMenu-BfQCWaMH.js";import{g as V}from"./index-D3F1WhLb.js";import{_ as x}from"./index-YZ_VcAS6.js";const y={class:"cate-tree"},b={class:"cate-tree__search"},k={class:"cate-tree__tree"},E=["onContextmenu"],w=_(e({__name:"index",props:{type:{default:1},placeholder:{default:"请输入关键词"}},emits:["node-click"],setup(e,{emit:_}){const w=e,U=_,j=a(!1),z=l("treeRef"),C=a(""),R=a([]),M=()=>{U("node-click")};(async()=>{try{j.value=!0;const e=await V();R.value=c.mapTree(e.data,(e=>({...e,popupVisible:!1,isEdit:!1,icon:e=>e.expanded&&!e.isLeaf?s(x,{name:"file-open",size:16},null):e.expanded||e.isLeaf?s(x,{name:"file",size:16},null):s(x,{name:"file-close",size:16},null)}))),v((()=>{var e;null==(e=z.value)||e.expandAll()}))}finally{j.value=!1}})();const B=l("inputRef"),I=a(null),O=()=>{var e;(null==(e=I.value)?void 0:e.popupVisible)&&(I.value.popupVisible=!1)},T=e=>{var a,l;"move"!==e&&(f.info(`${e}-${(null==(a=I.value)?void 0:a.name)??""}`),O()),"edit"===e&&void 0!==(null==(l=I.value)?void 0:l.isEdit)&&(I.value.isEdit=!0,v((()=>{var e;null==(e=B.value)||e.focus()}))),"delete"===e&&h.warning({title:"提示",content:"是否确认删除？",hideCancel:!1,okButtonProps:{status:"danger"},onBeforeOk:()=>new Promise((e=>setTimeout((()=>e(!0)),300)))})},L=e=>{f.info(e.name),O()},P=()=>{var e;(null==(e=I.value)?void 0:e.isEdit)&&(I.value.isEdit=!1),V()};return(e,a)=>{const l=i("icon-search"),c=i("a-input"),v=i("a-trigger"),f=i("a-tree"),h=i("a-scrollbar");return t(),o("div",y,[n("div",b,[s(c,{modelValue:u(C),"onUpdate:modelValue":a[0]||(a[0]=e=>r(C)?C.value=e:null),"allow-clear":"",maxlength:20,placeholder:w.placeholder},{prefix:d((()=>[s(l)])),_:1},8,["modelValue","placeholder"])]),n("div",k,[s(h,{style:{height:"100%",overflow:"auto"},"outer-style":"height: 100%"},{default:d((()=>[s(f,{ref_key:"treeRef",ref:z,"show-line":"",size:"mini",data:u(R),"field-names":{key:"id"},onSelect:M},{title:d((e=>[s(v,{"popup-visible":e.popupVisible,"onUpdate:popupVisible":a=>e.popupVisible=a,trigger:"contextMenu","align-point":"","animation-name":"slide-dynamic-origin","auto-fit-transform-origin":"",position:"bl","scroll-to-close":""},{content:d((()=>[s(g,{"tree-data":u(R),onOnMenuItemClick:T,onOnTreeNodeClick:L},null,8,["tree-data"])])),default:d((()=>[e.isEdit?(t(),m(c,{key:1,ref_key:"inputRef",ref:B,modelValue:e.name,"onUpdate:modelValue":a=>e.name=a,size:"mini",placeholder:"请填写",onBlur:P},null,8,["modelValue","onUpdate:modelValue"])):(t(),o("div",{key:0,onContextmenu:a=>(e=>{var a;void 0!==(null==(a=I.value)?void 0:a.isEdit)&&(I.value.isEdit=!1),I.value=e})(e)},p(e.name),41,E))])),_:2},1032,["popup-visible","onUpdate:popupVisible"])])),_:1},8,["data"])])),_:1})])])}}}),[["__scopeId","data-v-33ed8487"]]);export{w as default};
