import{d as e,I as a,e as l,c as t,f as s,a as d,o,h as i,D as u,w as r,j as m,J as n}from"./index-CaTNYhxh.js";import{u as c}from"./useResetReactive-CVrmH7v1.js";import{u as p}from"./useDept-C0psf_Jk.js";import"./role-BwDBVdZ2.js";import{b as f}from"./dept-BtlGnOEc.js";const v=e({__name:"AddDeptModal",emits:["save-success"],setup(e,{expose:v,emit:h}){const w=h,V=a("formRef"),b=l(""),x=l(!1),_=t(()=>!!b.value),g=t(()=>_.value?"编辑部门":"新增部门"),{deptList:k,getDeptList:y}=p();y();const[j,U]=c({id:"",parentId:"",name:"",sort:0,status:1,description:""}),D={name:[{required:!0,message:"请输入部门名称"},{min:3,max:10,message:"长度在 3 - 10个字符"}]},I=()=>{var e;null==(e=V.value)||e.resetFields(),U()},R=async()=>{var e;try{if(await(null==(e=V.value)?void 0:e.validate()))return!1;return!!(await new Promise(e=>setTimeout(()=>e(!0),300)))&&(n.success("模拟保存成功"),w("save-success"),!0)}catch{return!1}};return v({add:()=>{b.value="",x.value=!0},edit:async e=>{k.value.length||await y(),b.value=e,x.value=!0;const a=await f.getDetail({id:e});Object.assign(j,a.data)}}),(e,a)=>{const l=s("a-tree-select"),t=s("a-form-item"),n=s("a-input"),c=s("a-input-number"),p=s("a-textarea"),f=s("a-switch"),v=s("a-form"),h=s("a-modal");return o(),d(h,{visible:i(x),"onUpdate:visible":a[5]||(a[5]=e=>u(x)?x.value=e:null),title:i(g),width:"90%","modal-style":{maxWidth:"520px"},"mask-closable":!1,onBeforeOk:R,onClose:I},{default:r(()=>[m(v,{ref_key:"formRef",ref:V,model:i(j),rules:D,size:"medium","auto-label-width":""},{default:r(()=>[m(t,{label:"上级部门",field:"parentId"},{default:r(()=>[m(l,{modelValue:i(j).parentId,"onUpdate:modelValue":a[0]||(a[0]=e=>i(j).parentId=e),"allow-clear":"",data:i(k),placeholder:"请选择上级部门","field-names":{key:"id",title:"name",children:"children"}},null,8,["modelValue","data"])]),_:1}),m(t,{label:"部门名称",field:"name"},{default:r(()=>[m(n,{modelValue:i(j).name,"onUpdate:modelValue":a[1]||(a[1]=e=>i(j).name=e),modelModifiers:{trim:!0},placeholder:"请输入部门名称","allow-clear":"","max-length":10},null,8,["modelValue"])]),_:1}),m(t,{label:"排序",field:"sort"},{default:r(()=>[m(c,{modelValue:i(j).sort,"onUpdate:modelValue":a[2]||(a[2]=e=>i(j).sort=e),style:{width:"120px"}},null,8,["modelValue"])]),_:1}),m(t,{label:"描述",field:"description"},{default:r(()=>[m(p,{modelValue:i(j).description,"onUpdate:modelValue":a[3]||(a[3]=e=>i(j).description=e),modelModifiers:{trim:!0},"max-length":200,placeholder:"请填写描述","auto-size":{minRows:3},"show-word-limit":""},null,8,["modelValue"])]),_:1}),m(t,{label:"状态",field:"status"},{default:r(()=>[m(f,{modelValue:i(j).status,"onUpdate:modelValue":a[4]||(a[4]=e=>i(j).status=e),type:"round","checked-value":1,"unchecked-value":0,"checked-text":"正常","unchecked-text":"禁用"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible","title"])}}});export{v as _};
