import{u as e}from"./index-DOgefSiK.js";import{_ as n}from"./index-DAjzMUd2.js";import{_ as a}from"./GiForm-DpzBiNZT.js";import{O as t,a as s}from"./regexp-CZKnpGWl.js";import{ah as r,d as o,U as l,a3 as i,I as m,f as p,o as c,a as u,w as d,i as f,j as y,h as g,E as v,D as b,M as w,a8 as x,a5 as h}from"./index-B-FIAI3U.js";const _=e=>r.get("/area/getAreaList",e),C=o({__name:"Card3",setup(r){const{width:o}=e(),C=l({name:"",phone:"",province:"",city:"",area:""});i((()=>{C.province="440000",C.city="440300",C.area="440307"}));const R=m("formRef"),F=l([{type:"input",label:"姓名",field:"name",span:{xs:24,sm:12},props:{maxLength:4},rules:[{required:!0,message:"请输入姓名"},{maxLength:4,message:"姓名不超过4个字符"},{match:t,message:"仅支持中文姓名"}]},{type:"input",label:"手机",field:"phone",span:{xs:24,sm:12},props:{maxLength:11},rules:[{required:!0,message:"请输入手机号"},{match:s,message:"手机号格式不正确"}]},{type:"select",label:"省",field:"province",request:()=>_({type:"province"}),resultFormat:e=>e.data.map((e=>({label:e.label,value:e.code}))),cascader:["city"],init:!0},{type:"select",label:"市",field:"city",request:e=>_({type:"city",code:e.province}),resultFormat:e=>e.data.map((e=>({label:e.label,value:e.code}))),cascader:["area"]},{type:"select",label:"区",field:"area",request:e=>_({type:"area",code:e.city}),resultFormat:e=>e.data.map((e=>({label:e.label,value:e.code})))},{type:"input",label:"",field:"btns",span:24}]),j=async()=>{var e,n;if(await(null==(n=null==(e=R.value)?void 0:e.formRef)?void 0:n.validate()))return!1;w.success("验证通过")},L=()=>{var e,n;null==(n=null==(e=R.value)?void 0:e.formRef)||n.resetFields()},q=()=>{x.open({title:"数据结构",content:()=>h(n,{codeJson:"\n<template>\n  <a-card title=\"配置表单-动态级联\">\n    <template #extra>\n      <a-button type=\"primary\" status=\"warning\" @click=\"onViewCode\">\n        <template #icon><icon-code /></template>\n        <span>查看代码</span>\n      </a-button>\n    </template>\n    <a-row :gutter=\"30\">\n      <a-col :xs=\"24\" :sm=\"24\" :md=\"12\">\n        <GiForm ref=\"formRef\" v-model=\"form\" :columns=\"columns\"\n          :grid-item-props=\"{ span: { xs: 24, sm: 12, md: 12, lg: 8 } }\">\n          <template #btns>\n            <a-row justify=\"end\" class=\"w-full\">\n              <a-space>\n                <a-button type=\"primary\" @click=\"save\">提交</a-button>\n                <a-button @click=\"reset\">重置</a-button>\n              </a-space>\n            </a-row>\n          </template>\n        </GiForm>\n      </a-col>\n      <a-col :xs=\"24\" :sm=\"24\" :md=\"12\">\n        <a-alert type=\"warning\" class=\"gi_mb\">具体配置看源码</a-alert>\n        <GiCodeView :code-json=\"JSON.stringify(form, null, '\t')\"></GiCodeView>\n      </a-col>\n    </a-row>\n  </a-card>\n</template>\n\n<script setup lang=\"ts\">\nimport { Drawer, Message } from '@arco-design/web-vue'\nimport { useWindowSize } from '@vueuse/core'\nimport Card3Json from './code/card3-json'\nimport GiCodeView from '@/components/GiCodeView/index.vue'\nimport { type ColumnItem, GiForm } from '@/components/GiForm'\nimport * as Regexp from '@/utils/regexp'\nimport { getAreaList } from '@/apis/area'\n\nconst { width } = useWindowSize()\n\nconst form = reactive({\n  name: '',\n  phone: '',\n  province: '',\n  city: '',\n  area: ''\n})\n\nonMounted(() => {\n  form.province = '440000'\n  form.city = '440300'\n  form.area = '440307'\n})\n\nconst formRef = useTemplateRef('formRef')\n\nconst columns: ColumnItem<typeof form>[] = reactive([\n  {\n    type: 'input',\n    label: '姓名',\n    field: 'name',\n    span: { xs: 24, sm: 12 },\n    props: {\n      maxLength: 4\n    },\n    rules: [\n      { required: true, message: '请输入姓名' },\n      { maxLength: 4, message: '姓名不超过4个字符' },\n      { match: Regexp.OnlyCh, message: '仅支持中文姓名' }\n    ]\n  },\n  {\n    type: 'input',\n    label: '手机',\n    field: 'phone',\n    span: { xs: 24, sm: 12 },\n    props: {\n      maxLength: 11\n    },\n    rules: [\n      { required: true, message: '请输入手机号' },\n      { match: Regexp.Phone, message: '手机号格式不正确' }\n    ]\n  },\n  {\n    type: 'select',\n    label: '省',\n    field: 'province',\n    request: () => getAreaList({ type: 'province' }),\n    resultFormat: (res) => res.data.map((i: any) => ({ label: i.label, value: i.code })),\n    cascader: ['city'],\n    init: true\n  },\n  {\n    type: 'select',\n    label: '市',\n    field: 'city',\n    request: (form) => getAreaList({ type: 'city', code: form.province }),\n    resultFormat: (res) => res.data.map((i: any) => ({ label: i.label, value: i.code })),\n    cascader: ['area']\n  },\n  {\n    type: 'select',\n    label: '区',\n    field: 'area',\n    request: (form) => getAreaList({ type: 'area', code: form.city }),\n    resultFormat: (res) => res.data.map((i: any) => ({ label: i.label, value: i.code }))\n  },\n  {\n    type: 'input',\n    label: '',\n    field: 'btns',\n    span: 24\n  }\n])\n\nconst save = async () => {\n  const error = await formRef.value?.formRef?.validate()\n  if (error) return false\n  Message.success('验证通过')\n}\n\nconst reset = () => {\n  formRef.value?.formRef?.resetFields()\n}\n\nconst onViewCode = () => {\n  Drawer.open({\n    title: '数据结构',\n    content: () => h(GiCodeView, { codeJson: Card3Json, type: 'vue' }),\n    width: width.value < 500 ? '100%' : 560\n  })\n}\n<\/script>\n\n<style lang=\"scss\" scoped></style>\n",type:"vue"}),width:o.value<500?"100%":560})};return(e,t)=>{const s=p("icon-code"),r=p("a-button"),o=p("a-space"),l=p("a-row"),i=p("a-col"),m=p("a-alert"),w=p("a-card");return c(),u(w,{title:"配置表单-动态级联"},{extra:d((()=>[f(r,{type:"primary",status:"warning",onClick:q},{icon:d((()=>[f(s)])),default:d((()=>[t[1]||(t[1]=y("span",null,"查看代码",-1))])),_:1})])),default:d((()=>[f(l,{gutter:30},{default:d((()=>[f(i,{xs:24,sm:24,md:12},{default:d((()=>[f(g(a),{ref_key:"formRef",ref:R,modelValue:g(C),"onUpdate:modelValue":t[0]||(t[0]=e=>v(C)?C.value=e:null),columns:g(F),"grid-item-props":{span:{xs:24,sm:12,md:12,lg:8}}},{btns:d((()=>[f(l,{justify:"end",class:"w-full"},{default:d((()=>[f(o,null,{default:d((()=>[f(r,{type:"primary",onClick:j},{default:d((()=>t[2]||(t[2]=[b("提交")]))),_:1}),f(r,{onClick:L},{default:d((()=>t[3]||(t[3]=[b("重置")]))),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue","columns"])])),_:1}),f(i,{xs:24,sm:24,md:12},{default:d((()=>[f(m,{type:"warning",class:"gi_mb"},{default:d((()=>t[4]||(t[4]=[b("具体配置看源码")]))),_:1}),f(n,{"code-json":JSON.stringify(g(C),null,"\t")},null,8,["code-json"])])),_:1})])),_:1})])),_:1})}}});export{C as _};
