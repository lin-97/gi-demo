import{_ as te}from"./index-Ci5iGC7A.js";import{f as ae,x as oe,dm as de,i as ue}from"./index-B70cmoY5.js";import{b as ne}from"./menu-C-iaCV4t.js";import{u as se}from"./useResetReactive-B5labgoQ.js";import{a9 as re}from"./arco-B8E_0xxC.js";import{e as ie,c as w,ac as me,a as T,h as n,j as s,k as r,a1 as l,Y as P,l as o,t as a,p,y as c,S as _,U as y,m as q,z as pe}from"./vue-Bh0u9iwh.js";const be=ie({__name:"AddMenuModal",props:{menus:{default:()=>[]}},emits:["save-success"],setup(A,{expose:E,emit:B}){const O=A,z=B,j=w(()=>{const i=JSON.parse(JSON.stringify(O.menus)),e=ae(i,f=>[1,2].includes(f.type));return oe.mapTree(e,f=>({id:f.id,title:f.title,children:f.children}))}),S={xs:24,sm:24,md:12,lg:12,xl:12,xxl:12},x={xs:12,sm:12,md:8,lg:8,xl:8,xxl:8},h=me("formRef"),U=T(""),g=T(!1),I=w(()=>!!U.value),D=w(()=>I.value?"编辑菜单":"新增菜单"),v=T(!1),[t,F]=se({type:1,icon:"",svgIcon:"",title:"",sort:0,status:1,path:"",component:"",keepAlive:!1,hidden:!0,parentId:"",redirect:"",breadcrumb:!0,showInTabs:!0,alwaysShow:!1,permission:""}),M=w(()=>de(t.path)),R={parentId:[{required:!0,message:"请选择上级菜单"}],title:[{required:!0,message:"请输入菜单标题"}],path:[{required:!0,message:"请输入路由路径"}],permission:[{required:!0,message:"请输入权限标识"}]},J=w(()=>{if([1,2].includes(t.type)){const{title:i,path:e}=R;return{title:i,path:e}}if(t.type===3){const{parentId:i,title:e,permission:m}=R;return{parentId:i,title:e,permission:m}}return{}}),G=()=>{h.value?.clearValidate()},H=()=>{U.value="",g.value=!0},W=async i=>{g.value=!0,U.value=i;const e=await ne.getDetail({id:i});Object.assign(t,e.data),ue(t.path)&&(v.value=!0)},Y=()=>{h.value?.resetFields(),F()},K=async()=>{try{return await h.value?.validate()?!1:await new Promise(m=>setTimeout(()=>m(!0),300))?(re.success("模拟保存成功"),z("save-success"),!0):!1}catch{return!1}};return E({add:H,edit:W}),(i,e)=>{const m=n("a-radio"),f=n("a-radio-group"),u=n("a-form-item"),L=n("a-tree-select"),N=te,Q=n("icon-question-circle-fill"),X=n("a-tooltip"),V=n("a-col"),C=n("a-row"),b=n("a-input"),Z=n("a-tag"),k=n("a-switch"),$=n("a-input-number"),ee=n("a-form"),le=n("a-modal");return r(),s(le,{visible:l(g),"onUpdate:visible":e[18]||(e[18]=d=>P(g)?g.value=d:null),title:l(D),width:"calc(100% - 20px)","modal-style":{maxWidth:"625px"},"body-style":{maxHeight:"70vh"},"mask-closable":!1,onBeforeOk:K,onClose:Y},{default:o(()=>[a(ee,{ref_key:"formRef",ref:h,model:l(t),rules:l(J),"auto-label-width":""},{default:o(()=>[a(u,{label:"菜单类型",field:"type"},{default:o(()=>[a(f,{modelValue:l(t).type,"onUpdate:modelValue":e[0]||(e[0]=d=>l(t).type=d),type:"button",disabled:l(I),onChange:G},{default:o(()=>[a(m,{value:1},{default:o(()=>e[19]||(e[19]=[c("目录",-1)])),_:1,__:[19]}),a(m,{value:2},{default:o(()=>e[20]||(e[20]=[c("菜单",-1)])),_:1,__:[20]}),a(m,{value:3},{default:o(()=>e[21]||(e[21]=[c("按钮",-1)])),_:1,__:[21]})]),_:1},8,["modelValue","disabled"])]),_:1}),a(u,{label:"上级菜单",field:"parentId"},{default:o(()=>[a(L,{modelValue:l(t).parentId,"onUpdate:modelValue":e[1]||(e[1]=d=>l(t).parentId=d),placeholder:"请选择上级菜单","allow-clear":"","allow-search":"",disabled:l(I),data:l(j),"field-names":{key:"id",title:"title",children:"children"}},null,8,["modelValue","disabled","data"])]),_:1}),[1,2].includes(l(t).type)?(r(),s(C,{key:0,gutter:16},{default:o(()=>[a(V,_(y(S)),{default:o(()=>[a(u,{label:"自定义图标",field:"svgIcon"},{default:o(()=>[a(N,{modelValue:l(t).svgIcon,"onUpdate:modelValue":e[2]||(e[2]=d=>l(t).svgIcon=d),type:"custom"},null,8,["modelValue"]),a(X,{content:"优先显示"},{default:o(()=>[a(Q,{size:18,style:{color:"rgba(var(--warning-6))","margin-left":"8px"}})]),_:1})]),_:1})]),_:1},16),a(V,_(y(S)),{default:o(()=>[a(u,{label:"菜单图标",field:"icon"},{default:o(()=>[a(N,{modelValue:l(t).icon,"onUpdate:modelValue":e[3]||(e[3]=d=>l(t).icon=d)},null,8,["modelValue"])]),_:1})]),_:1},16)]),_:1})):p("",!0),a(u,{label:"菜单标题",field:"title"},{default:o(()=>[a(b,{modelValue:l(t).title,"onUpdate:modelValue":e[4]||(e[4]=d=>l(t).title=d),modelModifiers:{trim:!0},placeholder:"请输入菜单标题","allow-clear":"","max-length":10},null,8,["modelValue"])]),_:1}),[1,2].includes(l(t).type)?(r(),s(u,{key:1,label:"路由路径",field:"path"},{extra:o(()=>[q("div",null,[e[22]||(e[22]=q("span",null,"路由名称由系统自动生成：",-1)),l(M)?(r(),s(Z,{key:0},{default:o(()=>[c(pe(l(M)),1)]),_:1})):p("",!0)])]),default:o(()=>[a(b,{modelValue:l(t).path,"onUpdate:modelValue":e[5]||(e[5]=d=>l(t).path=d),modelModifiers:{trim:!0},placeholder:"请输入路由路径","allow-clear":"","max-length":50},null,8,["modelValue"])]),_:1})):p("",!0),[1,2].includes(l(t).type)&&!l(v)?(r(),s(u,{key:2,label:"重定向",field:"redirect"},{default:o(()=>[a(b,{modelValue:l(t).redirect,"onUpdate:modelValue":e[6]||(e[6]=d=>l(t).redirect=d),modelModifiers:{trim:!0},placeholder:"请输入重定向地址","allow-clear":"","max-length":50},null,8,["modelValue"])]),_:1})):p("",!0),[1,2].includes(l(t).type)?(r(),s(u,{key:3,label:"是否外链",field:"isExternalUrl"},{default:o(()=>[a(f,{modelValue:l(v),"onUpdate:modelValue":e[7]||(e[7]=d=>P(v)?v.value=d:null),type:"button"},{default:o(()=>[a(m,{value:!0},{default:o(()=>e[23]||(e[23]=[c("是",-1)])),_:1,__:[23]}),a(m,{value:!1},{default:o(()=>e[24]||(e[24]=[c("否",-1)])),_:1,__:[24]})]),_:1},8,["modelValue"])]),_:1})):p("",!0),l(t).type===2?(r(),s(u,{key:4,label:"组件路径",field:"component"},{default:o(()=>[l(v)?(r(),s(b,{key:0,modelValue:l(t).component,"onUpdate:modelValue":e[8]||(e[8]=d=>l(t).component=d),modelModifiers:{trim:!0},placeholder:"请输入组件路径","allow-clear":"","max-length":50},null,8,["modelValue"])):(r(),s(b,{key:1,modelValue:l(t).component,"onUpdate:modelValue":e[9]||(e[9]=d=>l(t).component=d),modelModifiers:{trim:!0},placeholder:"请输入组件路径","allow-clear":"","max-length":50},{prepend:o(()=>e[25]||(e[25]=[c("@/views/",-1)])),append:o(()=>e[26]||(e[26]=[c(".vue",-1)])),_:1},8,["modelValue"]))]),_:1})):p("",!0),[1,2].includes(l(t).type)?(r(),s(C,{key:5,gutter:16},{default:o(()=>[a(V,_(y(x)),{default:o(()=>[a(u,{label:"状态",field:"status"},{default:o(()=>[a(k,{modelValue:l(t).status,"onUpdate:modelValue":e[10]||(e[10]=d=>l(t).status=d),type:"round","checked-value":1,"unchecked-value":0,"checked-text":"启用","unchecked-text":"禁用"},null,8,["modelValue"])]),_:1})]),_:1},16),a(V,_(y(x)),{default:o(()=>[a(u,{label:"是否隐藏",field:"hidden"},{default:o(()=>[a(k,{modelValue:l(t).hidden,"onUpdate:modelValue":e[11]||(e[11]=d=>l(t).hidden=d),type:"round","checked-value":!0,"unchecked-value":!1,"checked-text":"是","unchecked-text":"否"},null,8,["modelValue"])]),_:1})]),_:1},16),a(V,_(y(x)),{default:o(()=>[a(u,{label:"是否缓存",field:"keepAlive"},{default:o(()=>[a(k,{modelValue:l(t).keepAlive,"onUpdate:modelValue":e[12]||(e[12]=d=>l(t).keepAlive=d),type:"round","checked-value":!0,"unchecked-value":!1,"checked-text":"是","unchecked-text":"否"},null,8,["modelValue"])]),_:1})]),_:1},16),a(V,_(y(x)),{default:o(()=>[a(u,{label:"面包屑",field:"breadcrumb"},{default:o(()=>[a(k,{modelValue:l(t).breadcrumb,"onUpdate:modelValue":e[13]||(e[13]=d=>l(t).breadcrumb=d),type:"round","checked-value":!0,"unchecked-value":!1,"checked-text":"显示","unchecked-text":"隐藏"},null,8,["modelValue"])]),_:1})]),_:1},16),a(V,_(y(x)),{default:o(()=>[l(t).type===1?(r(),s(u,{key:0,label:"总是显示",field:"alwaysShow"},{default:o(()=>[a(k,{modelValue:l(t).alwaysShow,"onUpdate:modelValue":e[14]||(e[14]=d=>l(t).alwaysShow=d),type:"round","checked-value":!0,"unchecked-value":!1,"checked-text":"显示","unchecked-text":"隐藏"},null,8,["modelValue"])]),_:1})):p("",!0),l(t).type===2?(r(),s(u,{key:1,label:"页签显示",field:"showInTabs"},{default:o(()=>[a(k,{modelValue:l(t).showInTabs,"onUpdate:modelValue":e[15]||(e[15]=d=>l(t).showInTabs=d),type:"round","checked-value":!0,"unchecked-value":!1,"checked-text":"显示","unchecked-text":"隐藏"},null,8,["modelValue"])]),_:1})):p("",!0)]),_:1},16)]),_:1})):p("",!0),l(t).type===3?(r(),s(u,{key:6,label:"权限标识",field:"permission"},{default:o(()=>[a(b,{modelValue:l(t).permission,"onUpdate:modelValue":e[16]||(e[16]=d=>l(t).permission=d),modelModifiers:{trim:!0},placeholder:"sys:btn:add","allow-clear":"","max-length":20},null,8,["modelValue"])]),_:1})):p("",!0),a(u,{label:"菜单排序",field:"sort"},{default:o(()=>[a($,{modelValue:l(t).sort,"onUpdate:modelValue":e[17]||(e[17]=d=>l(t).sort=d),placeholder:"请输入菜单排序",min:1,mode:"button",style:{width:"120px"}},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["visible","title"])}}});export{be as _};
