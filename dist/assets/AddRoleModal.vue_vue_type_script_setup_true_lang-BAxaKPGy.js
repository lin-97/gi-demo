import{b as z}from"./role-CQOef2Ft.js";import"./index-DBvjnvFZ.js";import{u as B}from"./useResetReactive-C4hw2Er8.js";import{a9 as j}from"./arco-CDZlpuCh.js";import{e as A,ac as F,a as p,c as _,h as l,j as I,k as O,a1 as t,Y as P,l as n,t as s}from"./vue-_iYK9Zi6.js";const $=A({__name:"AddRoleModal",emits:["save-success"],setup(T,{expose:v,emit:w}){const b=w,u=F("formRef"),c=p(""),f=_(()=>!!c.value),x=_(()=>f.value?"编辑角色":"新增角色"),r=p(!1),[a,V]=B({name:"",code:"",status:1,description:""}),h={name:[{required:!0,message:"请输入角色名称"},{min:3,max:10,message:"长度在 3 - 10个字符"}],code:[{required:!0,message:"请输入角色编码"},{match:/^[a-z]\w*$/i,message:"格式不对！只能英文开头，包含英文数字下划线"}],status:[{required:!0}]},g=()=>{c.value="",r.value=!0},k=async d=>{r.value=!0,c.value=d;const e=await z.getDetail({id:d});Object.assign(a,e.data)},R=()=>{u.value?.resetFields(),V()},y=async()=>{try{return await u.value?.validate()?!1:await new Promise(i=>setTimeout(()=>i(!0),300))?(j.success("模拟保存成功"),b("save-success"),!0):!1}catch{return!1}};return v({add:g,edit:k}),(d,e)=>{const i=l("a-input"),m=l("a-form-item"),M=l("a-textarea"),U=l("a-switch"),C=l("a-form"),q=l("a-modal");return O(),I(q,{visible:t(r),"onUpdate:visible":e[4]||(e[4]=o=>P(r)?r.value=o:null),title:t(x),width:"90%","mask-closable":!1,"modal-style":{maxWidth:"520px"},onBeforeOk:y,onClose:R},{default:n(()=>[s(C,{ref_key:"formRef",ref:u,model:t(a),rules:h,size:"medium","auto-label-width":""},{default:n(()=>[s(m,{label:"角色名称",field:"name"},{default:n(()=>[s(i,{modelValue:t(a).name,"onUpdate:modelValue":e[0]||(e[0]=o=>t(a).name=o),modelModifiers:{trim:!0},placeholder:"请输入角色名称","allow-clear":"","max-length":10},null,8,["modelValue"])]),_:1}),s(m,{label:"角色编码",field:"code"},{default:n(()=>[s(i,{modelValue:t(a).code,"onUpdate:modelValue":e[1]||(e[1]=o=>t(a).code=o),modelModifiers:{trim:!0},placeholder:"请输入角色编码","allow-clear":"",disabled:t(f),"max-length":10},null,8,["modelValue","disabled"])]),_:1}),s(m,{label:"描述",field:"description"},{default:n(()=>[s(M,{modelValue:t(a).description,"onUpdate:modelValue":e[2]||(e[2]=o=>t(a).description=o),modelModifiers:{trim:!0},placeholder:"请填写描述","max-length":200,"show-word-limit":"","auto-size":{minRows:3,maxRows:5}},null,8,["modelValue"])]),_:1}),s(m,{label:"状态",field:"status"},{default:n(()=>[s(U,{modelValue:t(a).status,"onUpdate:modelValue":e[3]||(e[3]=o=>t(a).status=o),type:"round","checked-value":1,"unchecked-value":0,"checked-text":"正常","unchecked-text":"禁用"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible","title"])}}});export{$ as _};
