import{b as A}from"./dept-DEF04NIx.js";import"./index-ClEKbW6k.js";import{u as F}from"./useResetReactive-YcB0T7DE.js";import{u as L}from"./useDept-YkJGKCoq.js";import"./role-Cg_-WBBn.js";import{a9 as O}from"./arco-BfMEPP4p.js";import{e as P,ac as T,a as _,c as v,h as s,j as q,k as E,$ as t,Y as N,l as n,t as o}from"./vue-N_SRJc_9.js";const S=P({__name:"AddDeptModal",emits:["save-success"],setup(W,{expose:b,emit:w}){const V=w,m=T("formRef"),u=_(""),r=_(!1),x=v(()=>!!u.value),h=v(()=>x.value?"编辑部门":"新增部门"),{deptList:p,getDeptList:f}=L();f();const[a,k]=F({id:"",parentId:"",name:"",sort:0,status:1,description:""}),g={name:[{required:!0,message:"请输入部门名称"},{min:3,max:10,message:"长度在 3 - 10个字符"}]},y=()=>{u.value="",r.value=!0},R=async d=>{p.value.length||await f(),u.value=d,r.value=!0;const e=await A.getDetail({id:d});Object.assign(a,e.data)},I=()=>{m.value?.resetFields(),k()},U=async()=>{try{return await m.value?.validate()?!1:await new Promise(c=>setTimeout(()=>c(!0),300))?(O.success("模拟保存成功"),V("save-success"),!0):!1}catch{return!1}};return b({add:y,edit:R}),(d,e)=>{const c=s("a-tree-select"),i=s("a-form-item"),C=s("a-input"),D=s("a-input-number"),M=s("a-textarea"),B=s("a-switch"),j=s("a-form"),z=s("a-modal");return E(),q(z,{visible:t(r),"onUpdate:visible":e[5]||(e[5]=l=>N(r)?r.value=l:null),title:t(h),width:"calc(100% - 20px)","modal-style":{maxWidth:"520px"},"mask-closable":!1,onBeforeOk:U,onClose:I},{default:n(()=>[o(j,{ref_key:"formRef",ref:m,model:t(a),rules:g,size:"medium","auto-label-width":""},{default:n(()=>[o(i,{label:"上级部门",field:"parentId"},{default:n(()=>[o(c,{modelValue:t(a).parentId,"onUpdate:modelValue":e[0]||(e[0]=l=>t(a).parentId=l),"allow-clear":"",data:t(p),placeholder:"请选择上级部门","field-names":{key:"id",title:"name",children:"children"}},null,8,["modelValue","data"])]),_:1}),o(i,{label:"部门名称",field:"name"},{default:n(()=>[o(C,{modelValue:t(a).name,"onUpdate:modelValue":e[1]||(e[1]=l=>t(a).name=l),modelModifiers:{trim:!0},placeholder:"请输入部门名称","allow-clear":"","max-length":10},null,8,["modelValue"])]),_:1}),o(i,{label:"排序",field:"sort"},{default:n(()=>[o(D,{modelValue:t(a).sort,"onUpdate:modelValue":e[2]||(e[2]=l=>t(a).sort=l),style:{width:"120px"}},null,8,["modelValue"])]),_:1}),o(i,{label:"描述",field:"description"},{default:n(()=>[o(M,{modelValue:t(a).description,"onUpdate:modelValue":e[3]||(e[3]=l=>t(a).description=l),modelModifiers:{trim:!0},"max-length":200,placeholder:"请填写描述","auto-size":{minRows:3},"show-word-limit":""},null,8,["modelValue"])]),_:1}),o(i,{label:"状态",field:"status"},{default:n(()=>[o(B,{modelValue:t(a).status,"onUpdate:modelValue":e[4]||(e[4]=l=>t(a).status=l),type:"round","checked-value":1,"unchecked-value":0,"checked-text":"正常","unchecked-text":"禁用"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible","title"])}}});export{S as _};
