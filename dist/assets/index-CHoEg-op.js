import{x as P,_ as A}from"./index-ClEKbW6k.js";import{g as k}from"./index-OObeJPPc.js";import{_ as f}from"./index-CwcoJ3a9.js";import L from"./RightMenu-CNTwB7CR.js";import{a9 as V,ac as S}from"./arco-BfMEPP4p.js";import{e as j,a as c,ac as y,h as l,n as C,k as d,m as b,t as n,$ as m,Y,l as s,j as q,z as F,A as E}from"./vue-N_SRJc_9.js";const G={class:"cate-tree"},H={class:"cate-tree__search"},J={class:"cate-tree__tree"},K=["onContextmenu"],Q=j({__name:"index",props:{type:{default:1},placeholder:{default:"请输入关键词"}},emits:["node-click"],setup(R,{emit:T}){const B=R,w=T,_=c(!1),v=y("treeRef"),u=c(""),p=c([]),M=()=>{w("node-click")};(async()=>{try{_.value=!0;const e=await k();p.value=P.mapTree(e.data,o=>({...o,popupVisible:!1,isEdit:!1,icon:i=>i.expanded&&!i.isLeaf?n(f,{name:"file-open",size:16},null):!i.expanded&&!i.isLeaf?n(f,{name:"file-close",size:16},null):n(f,{name:"file",size:16},null)})),E(()=>{v.value?.expandAll()})}finally{_.value=!1}})();const g=y("inputRef"),t=c(null),z=e=>{t.value?.isEdit!==void 0&&(t.value.isEdit=!1),t.value=e},h=()=>{t.value?.popupVisible&&(t.value.popupVisible=!1)},U=e=>{e!=="move"&&(V.info(`${e}-${t.value?.name??""}`),h()),e==="edit"&&t.value?.isEdit!==void 0&&(t.value.isEdit=!0,E(()=>{g.value?.focus()})),e==="delete"&&S.warning({title:"提示",content:"是否确认删除？",hideCancel:!1,okButtonProps:{status:"danger"},onBeforeOk:()=>new Promise(o=>setTimeout(()=>o(!0),300))})},N=e=>{V.info(e.name),h()},D=()=>{t.value?.isEdit&&(t.value.isEdit=!1),k()};return(e,o)=>{const i=l("icon-search"),x=l("a-input"),$=l("a-trigger"),I=l("a-tree"),O=l("a-scrollbar");return d(),C("div",G,[b("div",H,[n(x,{modelValue:m(u),"onUpdate:modelValue":o[0]||(o[0]=a=>Y(u)?u.value=a:null),"allow-clear":"",maxlength:20,placeholder:B.placeholder},{prefix:s(()=>[n(i)]),_:1},8,["modelValue","placeholder"])]),b("div",J,[n(O,{style:{height:"100%",overflow:"auto"},"outer-style":"height: 100%"},{default:s(()=>[n(I,{ref_key:"treeRef",ref:v,"show-line":"",size:"mini",data:m(p),"field-names":{key:"id"},onSelect:M},{title:s(a=>[n($,{"popup-visible":a.popupVisible,"onUpdate:popupVisible":r=>a.popupVisible=r,trigger:"contextMenu","align-point":"","animation-name":"slide-dynamic-origin","auto-fit-transform-origin":"",position:"bl","scroll-to-close":""},{content:s(()=>[n(L,{"tree-data":m(p),onOnMenuItemClick:U,onOnTreeNodeClick:N},null,8,["tree-data"])]),default:s(()=>[a.isEdit?(d(),q(x,{key:1,ref_key:"inputRef",ref:g,modelValue:a.name,"onUpdate:modelValue":r=>a.name=r,size:"mini",placeholder:"请填写",onBlur:D},null,8,["modelValue","onUpdate:modelValue"])):(d(),C("div",{key:0,onContextmenu:r=>z(a)},F(a.name),41,K))]),_:2},1032,["popup-visible","onUpdate:popupVisible"])]),_:1},8,["data"])]),_:1})])])}}}),oe=A(Q,[["__scopeId","data-v-55990f79"]]);export{oe as default};
