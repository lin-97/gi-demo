import{_ as A}from"./index-3av5scz5.js";import{_ as T}from"./GiForm-DXlAsORr.js";import{ac as q,a9 as b}from"./arco-Buj77_8l.js";import{a as L,X as U,e as k,r as y,h as s,n as G,k as w,t as o,l as i,a1 as n,m as g,j as M,y as R,Y}from"./vue-sr_Z8kjA.js";import{b as $}from"./index-obgcgijJ.js";import{_ as E}from"./GiCellStatus.vue_vue_type_script_setup_true_lang-BZwOLfRP.js";import"./index-nN1PoSln.js";import{u as F}from"./useTable-DZeM0WUV.js";import"./omit-C5mD95s9.js";import"./useBreakpoint-D2cRTq41.js";import"./index-Dru6jS8c.js";const K=c=>e=>{const l=L();q.open({title:e.title||c.title,content:()=>U(c.component,{ref:t=>l.value=t,multiple:e.multiple,queryParams:e.queryParams,...c.componentProps}),width:"90%",modalStyle:{maxWidth:"1000px"},onBeforeOk:async()=>{if(!l.value?.getSelectedData)return b.warning("组件必须暴露getSelectedData方法"),!1;const t=l.value?.getSelectedData?.()||[];return t.length?e?.onBeforeOk?await e.onBeforeOk(t):(e.onOk?.(t),!0):(b.warning(c.tip||"请选择数据"),!1)}})},W=k({__name:"index",props:{multiple:{type:Boolean,default:!1},queryParams:{default:()=>({})}},setup(c,{expose:e}){const l=c,t=y({username:""}),a=[{title:"序号",width:68,render:({rowIndex:r})=>o("span",null,[r+1," "])},{title:"姓名",dataIndex:"name",width:180},{title:"创建时间",dataIndex:"createTime",width:180},{title:"地址",dataIndex:"address",ellipsis:!0,tooltip:!0},{title:"状态",width:100,align:"center",render:({record:r})=>o(E,{status:r.status},null)}],{loading:d,tableData:u,pagination:p,selectedKeys:_,search:h,select:N,selectAll:C}=F(r=>$.getList({...r,...t,...l.queryParams}),{immediate:!0});function I(){return u.value.filter(r=>_.value.includes(r.id))}const S=()=>{t.username="",h()};return e({getSelectedData:I}),(r,m)=>{const v=s("a-input"),B=s("icon-search"),x=s("a-button"),P=s("icon-refresh"),V=s("a-space"),D=s("a-row"),O=s("a-table");return w(),G("div",null,[o(D,{justify:"end"},{default:i(()=>[o(V,{wrap:""},{default:i(()=>[o(v,{modelValue:n(t).username,"onUpdate:modelValue":m[0]||(m[0]=j=>n(t).username=j),placeholder:"输入用户名搜索","allow-clear":"",style:{"max-width":"250px"}},null,8,["modelValue"]),o(x,{type:"primary",onClick:n(h)},{icon:i(()=>[o(B)]),default:i(()=>[m[1]||(m[1]=g("span",null,"查询",-1))]),_:1,__:[1]},8,["onClick"]),o(x,{onClick:S},{icon:i(()=>[o(P)]),default:i(()=>[m[2]||(m[2]=g("span",null,"重置",-1))]),_:1,__:[2]})]),_:1})]),_:1}),o(O,{class:"gi_table","row-key":"id",loading:n(d),bordered:{cell:!0},columns:a,data:n(u),scroll:{x:"100%",y:"500px"},"row-selection":{type:l.multiple?"checkbox":"radio",showCheckedAll:!0},pagination:n(p),onSelect:n(N),onSelectAll:n(C)},null,8,["loading","data","row-selection","pagination","onSelect","onSelectAll"])])}}}),f=K({title:"选择用户",component:W}),le=k({__name:"index",setup(c){const e=y({radioId:"",radioName:"",chekboxId:"",chekboxName:"",asyncId:"",asyncName:""}),l=y([{type:"input-search",label:"单选",field:"radioName",props:{allowClear:!0,onSearch:()=>{f({onOk:t=>{e.radioId=t[0].id,e.radioName=t[0].name}})},onClear:()=>{e.radioId="",e.radioName=""}}},{type:"input-search",label:"多选",field:"chekboxName",props:{allowClear:!0,onSearch:()=>{f({multiple:!0,onOk:t=>{e.chekboxId=t.map(a=>a.id).join(","),e.chekboxName=t.map(a=>a.name).join(",")}})},onClear:()=>{e.chekboxId="",e.chekboxName=""}}},{type:"input-search",label:"异步",field:"asyncName",props:{allowClear:!0,onSearch:()=>{f({multiple:!0,onBeforeOk:async t=>(await new Promise(a=>setTimeout(()=>a(!0),1e3)),e.asyncId=t.map(a=>a.id).join(","),e.asyncName=t.map(a=>a.name).join(","),!0)})},onClear:()=>{e.asyncId="",e.asyncName=""}}}]);return(t,a)=>{const d=s("a-alert"),u=T,p=A;return w(),M(p,{margin:"","body-style":{overflowY:"auto"}},{default:i(()=>[o(d,{style:{"margin-bottom":"20px"}},{default:i(()=>a[1]||(a[1]=[R("通过函数调用表格弹窗",-1)])),_:1,__:[1]}),o(u,{modelValue:n(e),"onUpdate:modelValue":a[0]||(a[0]=_=>Y(e)?e.value=_:null),columns:n(l)},null,8,["modelValue","columns"])]),_:1})}}});export{le as default};
