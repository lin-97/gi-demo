const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/FileList-BPI67y7E.js","assets/vue-sr_Z8kjA.js","assets/FileImage-BfUXi3jk.js","assets/index-Dh4v2jxe.js","assets/index-nN1PoSln.js","assets/arco-Buj77_8l.js","assets/index-DM5pURq9.css","assets/index-BkwKUk0m.css","assets/file-vS2Qaiq0.js","assets/FileImage-LFgiRRbw.css","assets/FileRightMenu-DHBheMz2.js","assets/index-CovHo9GX.js","assets/index-BQ7gjrEP.css","assets/FileRightMenu-CGYZzzB_.css","assets/FileList-DdJYKQTw.css"])))=>i.map(i=>d[i]);
import{h as de,c_ as re,c$ as ue,_ as pe}from"./index-nN1PoSln.js";import{_ as _e}from"./index-Dh4v2jxe.js";import{_ as me,a as p,X as A,c as j,e as fe,aa as ve,a7 as ge,o as he,ar as ye,h as n,n as O,k as v,t as e,l as t,y as k,m as q,F as we,P as ke,j as h,z as G,O as Ce,a1 as a,p as Fe,M as N,N as P,as as Me}from"./vue-sr_Z8kjA.js";import{q as be}from"./viewer-B-FwmSYY.js";import{I as W,F as xe}from"./file-vS2Qaiq0.js";import Ie from"./ModalContent-DZOhqtzE.js";import{ae as Se,ac as y,a9 as C}from"./arco-Buj77_8l.js";import Te from"./ModalContent-v69iJtBb.js";import{_ as Ne}from"./ModalContent.vue_vue_type_script_setup_true_lang-BMSH1YFI.js";import{_ as Pe}from"./ModalContent.vue_vue_type_script_setup_true_lang-CmZhk4zN.js";import Re from"./FileGrid-DDrx83E6.js";import Ae from"./FilePath-C6gaN7nQ.js";import"./index-Dru6jS8c.js";import"./FileImage-BfUXi3jk.js";import"./FileRightMenu-DHBheMz2.js";import"./index-CovHo9GX.js";function Le(l){return de.get("/file/getFileList",l)}function Be(l,c){const i=document.createElement("div");document.body.appendChild(i);const d=me(l,{...c,onClose:()=>{setTimeout(()=>{d.unmount(),document.body.removeChild(i),c?.callback&&c?.callback()},350)}});d.use(Se),d.use(re),d.mount(i)}let R="";function Ve(l){if(!R)return R=l.id,Be(Ie,{data:l,callback:()=>{R=""}})}function Ee(l,c){const i=p();return y.open({title:"移动到",width:"90%",modalStyle:{maxWidth:"500px"},modalAnimationName:"el-dialog",maskAnimationName:"el-mask",content:()=>A(Te,{ref:d=>{i.value=d,i.value?.setForm({id:l.id,path:l.filePath})}}),onBeforeOk:async()=>await i.value?.formRef?.validate()?!1:(await new Promise(u=>setTimeout(()=>u(!0),300)),C.success("移动成功"),!0)})}function $e(l,c){const i=p();return y.open({title:"重命名",width:"90%",modalStyle:{maxWidth:"450px"},modalAnimationName:"el-fade",content:()=>A(Ne,{ref:d=>{i.value=d,i.value?.setForm({id:l.id,name:l.name})}}),onBeforeOk:async()=>await i.value?.formRef?.validate()?!1:(await new Promise(u=>setTimeout(()=>u(!0),300)),C.success("重命名成功"),!0)})}function De(l){return y.open({title:"视频播放",width:"auto",modalStyle:{},content:()=>A(Pe,{data:l})})}function Oe(){const l=p("grid"),c=p([]),i=j(()=>c.value.map(r=>r.id));return{mode:l,selectedFileList:c,selectedFileIds:i,toggleMode:()=>{l.value=l.value==="grid"?"list":"grid"},addSelectedFileItem:r=>{if(i.value.includes(r.id)){const F=c.value.findIndex(M=>M.id===r.id);c.value.splice(F,1)}else c.value.push(r)}}}const qe={class:"file-main"},Ge=fe({__name:"index",setup(l){const c=Me(()=>ue(()=>import("./FileList-BPI67y7E.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]))),i=ve(),d=ge(),{mode:u,selectedFileIds:r,toggleMode:F,addSelectedFileItem:M}=Oe(),b=p(!1),_=p(!1),m=p([]),x=p("0");x.value=i.query.fileType||"0";const I=async()=>{try{b.value=!0,_.value=!1;const o=await Le({fileType:x.value});m.value=o.data.records}catch(o){return o}finally{b.value=!1}},z=()=>{I()};he(()=>{I()}),ye(o=>{x.value=o.query.fileType||"0",I()});const S=j(()=>m.value.filter(o=>W.includes(o.extendName)).map(o=>o.src??"")),L=o=>{if(C.success(`点击了文件-${o.name}`),W.includes(o.extendName)&&o.src&&S.value.length){const s=S.value.findIndex(g=>g===o.src);be({images:S.value,options:{initialViewIndex:s}})}o.extendName==="mp4"&&De(o),o.extendName==="mp3"&&Ve(o)},B=o=>{M(o)},V=(o,s)=>{C.success(`点击了${o}`),o==="delete"&&y.warning({title:"提示",content:"是否删除该文件？",hideCancel:!1,okButtonProps:{status:"danger"},onBeforeOk:async()=>await new Promise(g=>setTimeout(()=>g(!0),300))}),o==="rename"&&$e(s),o==="move"&&Ee(s),o==="detail"&&d.push({path:"/file/detail"})},Y=()=>{y.warning({title:"提示",content:"是否确认删除？",hideCancel:!1})};return(o,s)=>{const g=n("icon-upload"),f=n("a-button"),E=_e,$=n("a-doption"),U=n("a-dropdown"),X=n("a-option"),H=n("a-select"),J=n("a-input"),K=n("icon-search"),Q=n("a-input-group"),D=n("a-space"),Z=n("icon-delete"),ee=n("icon-select-all"),te=n("icon-swap"),T=n("a-tooltip"),oe=n("icon-filter"),ne=n("icon-apps"),ae=n("icon-list"),le=n("a-button-group"),ie=n("a-row"),se=n("a-empty"),ce=n("a-spin");return v(),O("div",qe,[e(Ae),e(ie,{justify:"space-between",class:"file-main__search"},{default:t(()=>[e(D,{wrap:""},{default:t(()=>[e(U,null,{content:t(()=>[e($,null,{icon:t(()=>[e(E,{name:"upload-file"})]),default:t(()=>[s[2]||(s[2]=q("span",null,"上传文件",-1))]),_:1,__:[2]}),e($,null,{icon:t(()=>[e(E,{name:"upload-folder"})]),default:t(()=>[s[3]||(s[3]=q("span",null,"上传文件夹",-1))]),_:1,__:[3]})]),default:t(()=>[e(f,{type:"primary",shape:"round"},{icon:t(()=>[e(g)]),default:t(()=>s[1]||(s[1]=[k("上传",-1)])),_:1})]),_:1}),e(Q,null,{default:t(()=>[e(H,{placeholder:"请选择","trigger-props":{autoFitPopupMinWidth:!0},style:{width:"150px"}},{default:t(()=>[(v(!0),O(we,null,ke(a(xe),w=>(v(),h(X,{key:w.value},{icon:t(()=>[(v(),h(Ce(w.icon),{size:"18",color:"#999"}))]),default:t(()=>[k(G(w.name),1)]),_:2},1024))),128))]),_:1}),e(J,{placeholder:"请输入关键词...","allow-clear":""}),e(f,{type:"primary",onClick:z},{icon:t(()=>[e(K)]),default:t(()=>s[4]||(s[4]=[k("搜索",-1)])),_:1})]),_:1})]),_:1}),e(D,{wrap:""},{default:t(()=>[a(_)?(v(),h(f,{key:0,disabled:!a(r).length,type:"primary",status:"danger",onClick:Y},{icon:t(()=>[e(Z)]),_:1},8,["disabled"])):Fe("",!0),e(f,{type:"primary",onClick:s[0]||(s[0]=w=>_.value=!a(_))},{icon:t(()=>[e(ee)]),default:t(()=>[k(G(a(_)?"取消批量":"批量操作"),1)]),_:1}),e(le,null,{default:t(()=>[e(T,{content:"传输列表",position:"bottom"},{default:t(()=>[e(f,null,{icon:t(()=>[e(te)]),_:1})]),_:1}),e(T,{content:"排序",position:"bottom"},{default:t(()=>[e(f,null,{icon:t(()=>[e(oe)]),_:1})]),_:1}),e(T,{content:"视图",position:"bottom"},{default:t(()=>[e(f,{onClick:a(F)},{icon:t(()=>[a(u)==="grid"?(v(),h(ne,{key:0})):(v(),h(ae,{key:1}))]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1}),e(ce,{class:"file-main__list",loading:a(b)},{default:t(()=>[N(e(Re,{data:a(m),"is-batch-mode":a(_),"selected-file-ids":a(r),onClick:L,onSelect:B,onRightMenuClick:V},null,8,["data","is-batch-mode","selected-file-ids"]),[[P,a(m).length&&a(u)==="grid"]]),N(e(a(c),{data:a(m),"is-batch-mode":a(_),"selected-file-ids":a(r),onClick:L,onSelect:B,onRightMenuClick:V},null,8,["data","is-batch-mode","selected-file-ids"]),[[P,a(m).length&&a(u)==="list"]]),N(e(se,null,null,512),[[P,!a(m).length]])]),_:1},8,["loading"])])}}}),lt=pe(Ge,[["__scopeId","data-v-dd2e44d9"]]);export{lt as default};
